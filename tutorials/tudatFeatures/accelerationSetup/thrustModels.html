

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.5. Thrust Guidance &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../../index.html"/>
        <link rel="up" title="2. Setting up State Derivative Models" href="index.html"/>
        <link rel="next" title="3. Simulator Set-Up" href="../propagationSetup/index.html"/>
        <link rel="prev" title="2.4. Aerodynamic Guidance" href="aerodynamicGuidance.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../applicationWalkthroughs/index.html">Application Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Tudat Libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../environmentSetup/index.html">1. Environment Set-up</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">2. Setting up State Derivative Models</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="frameworkAcceleration.html">2.1. Acceleration Model Set-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="rotModel.html">2.2. Torque Model Set-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="massModel.html">2.3. Mass Rate Model Set-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="aerodynamicGuidance.html">2.4. Aerodynamic Guidance</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">2.5. Thrust Guidance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../propagationSetup/index.html">3. Simulator Set-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../estimationSetup/index.html">4. Estimation Set-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../astroTools/index.html">5. Basic Astrodynamics Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lowThrustTrajectoryDesign/index.html">Low-Thrust Trajectory Design Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mathTools/index.html">6. Basic Mathematics Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../otherLibraries/index.html">7. Other Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="../index.html">Tudat Libraries</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">2. </span>Setting up State Derivative Models</a> &raquo;</li>
        
      <li><span class="section-number">2.5. </span>Thrust Guidance</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/tutorials/tudatFeatures/accelerationSetup/thrustModels.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="thrust-guidance">
<span id="tudatfeaturesthrustmodels"></span><h1><span class="section-number">2.5. </span>Thrust Guidance<a class="headerlink" href="#thrust-guidance" title="Permalink to this headline">¶</a></h1>
<p>This page deals with the inclusion of a thrust force into the dynamical model. Note that when using thrust, it may often be desirable to include the mass in the state vector. A good example of incorporating mass propagation is given in <a class="reference internal" href="../../applicationWalkthroughs/useOfThrustThrustForceAlongVelocityVector.html#walkthroughsuseofthrustthrustforcealongvelocityvector"><span class="std std-ref">Use of Thrust: Thrust Force Along Velocity Vector</span></a>. Details of combining mass and state propagation can be found on the <a class="reference internal" href="../propagationSetup/propagatorSettings.html#tudatfeaturespropagatorsettings"><span class="std std-ref">Propagator Settings: Basics</span></a> page.</p>
<p>In Tudat, we define the thrust force by two separate types of settings (which may or may not be linked):</p>
<blockquote>
<div><ul class="simple">
<li><p>The direction of the thrust.</p></li>
<li><p>The magnitude of the thrust.</p></li>
</ul>
</div></blockquote>
<p>In fact, when creating settings for a thrust force, the user needs to provide settings for these two aspects of the force model</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span> <span class="n">ThrustDirectionGuidanceSettings</span> <span class="o">&gt;</span> <span class="n">thrustDirectionSettings</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span> <span class="n">ThrustMagnitudeSettings</span> <span class="o">&gt;</span> <span class="n">thrustMagnitudeSettings</span><span class="p">;</span>

<span class="n">SelectedAccelerationMap</span> <span class="n">accelerationSettingsMap</span><span class="p">;</span>
<span class="n">accelerationSettingsMap</span><span class="p">[</span> <span class="s">&quot;Vehicle&quot;</span> <span class="p">][</span> <span class="s">&quot;Vehicle&quot;</span> <span class="p">].</span><span class="n">push_back</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span> <span class="n">ThrustAccelerationSettings</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">thrustDirectionSettings</span><span class="p">,</span> <span class="n">thrustMagnitudeSettings</span> <span class="p">)</span> <span class="p">);</span>
</pre></div>
</div>
<p>In the above code snippet, two things may stand out. First of all, we define the thrust force as one that the vehicle exerts on itself. Secondly, to define the thrust force, the user must provide two objects: one of type (derived from) <a class="reference internal" href="#ThrustDirectionGuidanceSettings" title="ThrustDirectionGuidanceSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustDirectionGuidanceSettings</span></code></a> and <a class="reference internal" href="#ThrustMagnitudeSettings" title="ThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustMagnitudeSettings</span></code></a>. The settings are used to create a <a class="reference internal" href="#ThrustAcceleration" title="ThrustAcceleration"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustAcceleration</span></code></a> acceleration object.</p>
<dl class="py class">
<dt id="ThrustAcceleration">
<em class="property">class </em><code class="sig-name descname">ThrustAcceleration</code><a class="headerlink" href="#ThrustAcceleration" title="Permalink to this definition">¶</a></dt>
<dd><p>Class contaning the properties of the thrust acceleration. Set by the settings classes described below.</p>
</dd></dl>

<div class="section" id="thrust-direction">
<h2><span class="section-number">2.5.1. </span>Thrust direction<a class="headerlink" href="#thrust-direction" title="Permalink to this headline">¶</a></h2>
<p>For the direction of the thrust, there are presently four available types of guidance. As is done for the acceleration models, some of the types of thrust direction require a specific derived class of <a class="reference internal" href="#ThrustDirectionGuidanceSettings" title="ThrustDirectionGuidanceSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustDirectionGuidanceSettings</span></code></a>, while others are defined purely by their type.</p>
<dl class="py class">
<dt id="ThrustDirectionGuidanceSettings">
<em class="property">class </em><code class="sig-name descname">ThrustDirectionGuidanceSettings</code><a class="headerlink" href="#ThrustDirectionGuidanceSettings" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for the setting for the direction of the thrust, in most cases not created directly by user. Important exception: thrust direction from existing orientation (see below).</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The thrust-direction in the inertial frame is defined by this class. The direction of the thrust in the body-fixed frame (which may be required for the computation of the thrust) is defined in the <a class="reference internal" href="#ThrustMagnitudeSettings" title="ThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustMagnitudeSettings</span></code></a> class.</p>
</div>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt id="ThrustDirectionFromStateGuidanceSettings">
<em class="property">class </em><code class="sig-name descname">ThrustDirectionFromStateGuidanceSettings</code><a class="headerlink" href="#ThrustDirectionFromStateGuidanceSettings" title="Permalink to this definition">¶</a></dt>
<dd><p>In various simplified cases, the thrust direction can be assumed to be in line with either the position or velocity w.r.t. some body. As an example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ThrustDirectionFromStateGuidanceSettings</span><span class="p">(</span>
        <span class="n">centralBodyName</span><span class="p">,</span> <span class="n">isThurstInVelocityDirection</span><span class="p">,</span> <span class="n">directionIsOppositeToVector</span> <span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">centralBodyName</span></code></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">std::string</span></code> which defines the name of the central body. Note that this need not be the same body as the center of propagation. For instance, the propagation of a vehicle may be done w.r.t. the Sun, while the thrust direction is computed from the state w.r.t. the Earth.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">isThurstInVelocityDirection</span></code></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> defining whether the thrust is colinear with velocity (if true) or position (if false) w.r.t. the central body.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">directionIsOppositeToVector</span></code></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> defining whether the thrust force is in the same direction, or opposite to the direction, of the position/velocity w.r.t. the central body.</p>
</div></blockquote>
</li>
</ul>
<dl class="py class">
<dt id="CustomThrustDirectionSettings">
<em class="property">class </em><code class="sig-name descname">CustomThrustDirectionSettings</code><a class="headerlink" href="#CustomThrustDirectionSettings" title="Permalink to this definition">¶</a></dt>
<dd><p>For a generalized thrust direction guidance, the thrust can be defined as an arbitrary function of time. This allows a broad range of options to be defined, at the expense of increased complexity (somehow this thrust direction needs to be manually defined):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CustomThrustDirectionSettings</span><span class="p">(</span>
        <span class="n">thrustDirectionFunction</span> <span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">thrustDirectionFunction</span></code></p>
<blockquote>
<div><p>A <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">Eigen::Vector3d(</span> <span class="pre">const</span> <span class="pre">double</span> <span class="pre">)</span> <span class="pre">&gt;</span></code> returning a the thrust direction in the inertial frame as an <code class="docutils literal notranslate"><span class="pre">Eigen::Vector3d</span></code> (which should be of unit norm!) as a function of a <code class="docutils literal notranslate"><span class="pre">double</span></code> (representing time). Details on how to create such an <code class="docutils literal notranslate"><span class="pre">std::function</span></code> are given on <a class="reference internal" href="../../basics/externalLibraries/utilityExamples.html#externalutilityexamples"><span class="std std-ref">Dynamic Memory: Usage Examples</span></a>.</p>
</div></blockquote>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using the <a class="reference internal" href="#CustomThrustDirectionSettings" title="CustomThrustDirectionSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomThrustDirectionSettings</span></code></a>, the inertial to body-fixed rotation cannot be unambiguously defined. If you require this rotation (for instance when you also incorporate aerodynamic forces), use the <a class="reference internal" href="#CustomThrustOrientationSettings" title="CustomThrustOrientationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomThrustOrientationSettings</span></code></a> class instead.</p>
</div>
<p>As a possible example of how to use this function:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span> <span class="n">myThrustFunction</span><span class="p">(</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">time</span><span class="p">,</span> <span class="k">const</span> <span class="n">NamedBodyMap</span><span class="o">&amp;</span> <span class="n">bodyMap</span> <span class="p">)</span>
<span class="p">{</span>
   <span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span> <span class="n">thrustDirection</span> <span class="o">=</span>
      <span class="c1">//... define algorithm to compute thurst based on current environment</span>

   <span class="k">return</span> <span class="n">thrustDirection</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span> <span class="p">)</span>
<span class="p">{</span>
   <span class="c1">// Define environment and other settings</span>
   <span class="n">NamedBodyMap</span> <span class="n">bodyMap</span> <span class="o">=</span> <span class="p">...</span>

   <span class="c1">// ...</span>
   <span class="c1">// ...</span>
   <span class="c1">// ...</span>

   <span class="c1">// Create custom thrust direction settings</span>
   <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span> <span class="n">CustomThrustDirectionSettings</span> <span class="o">&gt;</span><span class="p">(</span>
      <span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">myThrustFunction</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">,</span> <span class="n">bodyMap</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py class">
<dt id="CustomThrustOrientationSettings">
<em class="property">class </em><code class="sig-name descname">CustomThrustOrientationSettings</code><a class="headerlink" href="#CustomThrustOrientationSettings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>As an alternative expression for generalized thrust direction guidance, the thrust orientation can be defined as an arbitrary function of time. As with the custom thrust direction. this allows a broad range of options to be defined, at the expense of increased complexity).</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CustomThrustOrientationSettings</span><span class="p">(</span>
        <span class="n">thrustOrientationFunction</span> <span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">thrustOrientationFunction</span></code></p>
<blockquote>
<div><p>A <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">Eigen::Quaterniond(</span> <span class="pre">const</span> <span class="pre">double</span> <span class="pre">)</span> <span class="pre">&gt;</span></code> returning the rotation from body-fixed to inertial state, represented as an <code class="docutils literal notranslate"><span class="pre">Eigen::Quaterniond</span></code> (which should be of unit norm!) as a function of a <code class="docutils literal notranslate"><span class="pre">double</span></code> (representing time). See <a class="reference internal" href="#CustomThrustDirectionSettings" title="CustomThrustDirectionSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomThrustDirectionSettings</span></code></a> for an example on how to realize this construction.</p>
</div></blockquote>
</li>
</ul>
<dl class="py class">
<dt id="MeeCostateBasedThrustDirectionSettings">
<em class="property">class </em><code class="sig-name descname">MeeCostateBasedThrustDirectionSettings</code><a class="headerlink" href="#MeeCostateBasedThrustDirectionSettings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>By using these settings for the thrust direction, the so-called co-states of the Modified Equinoctial elements are used to determine the direction of the thrust. Details of this model are given by Kluever (2010), Boudestijn (2014) and Hogervorst (2017).</p>
<dl class="py method">
<dt>
<code class="sig-name descname">Thrust direction from existing orientation</code></dt>
<dd><blockquote>
<div><p>In some cases, the vehicle’s orientation may be predetermined, either due to aerodynamic guidance of concurrent propagation of the rotational equations of motion. In such a case, the thrust direction is computed from the body-fixed thrust direction (defined in <a class="reference internal" href="#ThrustMagnitudeSettings" title="ThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustMagnitudeSettings</span></code></a>) and the existing vehicle orientation. This thrust direction does not require a specific derived class, but instead only requires the input of <code class="docutils literal notranslate"><span class="pre">thrust_direction_from_existing_body_orientation</span></code> to the <a class="reference internal" href="#ThrustDirectionGuidanceSettings" title="ThrustDirectionGuidanceSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustDirectionGuidanceSettings</span></code></a> constructor, so:</p>
</div></blockquote>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ThrustDirectionGuidanceSettings</span><span class="p">(</span>
        <span class="n">thrust_direction_from_existing_body_orientation</span><span class="p">,</span> <span class="s">&quot;&quot;</span> <span class="p">);</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="thrust-magnitude">
<h2><span class="section-number">2.5.2. </span>Thrust magnitude<a class="headerlink" href="#thrust-magnitude" title="Permalink to this headline">¶</a></h2>
<p>To define the thrust magnitude, there are presently three available types of settings, each with its own dedicated derived class of <a class="reference internal" href="#ThrustMagnitudeSettings" title="ThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustMagnitudeSettings</span></code></a>. We note that presently, the definition of the thrust direction in the body-fixed frame is also defined through these derived classes. In essence, the <a class="reference internal" href="#ThrustMagnitudeSettings" title="ThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustMagnitudeSettings</span></code></a> defines all local (to the vehicle systems) settings for the thrust, while <a class="reference internal" href="#ThrustDirectionGuidanceSettings" title="ThrustDirectionGuidanceSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustDirectionGuidanceSettings</span></code></a> defines how the full vehicle must orient itself in space for the required thrust direction to be achieved. At present, there is no direct option for thrust-vector control (i.e. modifying the thrust direction in the body-fixed frame). If your application requires such functionality, please contact the Tudat support team. The following thrust magnitude settings are available:</p>
<dl class="py class">
<dt id="ThrustMagnitudeSettings">
<em class="property">class </em><code class="sig-name descname">ThrustMagnitudeSettings</code><a class="headerlink" href="#ThrustMagnitudeSettings" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for the thrust magnitude settings.</p>
</dd></dl>

<dl class="py class">
<dt id="ConstantThrustMagnitudeSettings">
<em class="property">class </em><code class="sig-name descname">ConstantThrustMagnitudeSettings</code><a class="headerlink" href="#ConstantThrustMagnitudeSettings" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This model defines a constant thrust force and specific impulse:</p>
</div></blockquote>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ConstantThrustMagnitudeSettings</span><span class="p">(</span>
    <span class="n">thrustMagnitude</span><span class="p">,</span> <span class="n">specificImpulse</span><span class="p">,</span> <span class="n">bodyFixedThrustDirection</span> <span class="p">)</span><span class="o">:</span>
</pre></div>
</div>
</dd></dl>

<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">thrustMagnitude</span></code> Constant thrust magnitude to use (in Newtons, as <code class="docutils literal notranslate"><span class="pre">double</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">specificImpulse</span></code> Specific impulse to use for the thrust, as <code class="docutils literal notranslate"><span class="pre">double</span></code>. This quantity is used when applying a mass rate model in the propagation the vehicle dynamics, relating the thrust to the mass decrease of the vehicle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bodyFixedThrustDirection</span></code> Body-fixed thrust direction (positive x-direction by default) as an <code class="docutils literal notranslate"><span class="pre">Eigen::Vector3d</span></code>. Note that this should be a unit-vector, and represents the direction opposite to the nozzle direction.</p></li>
</ul>
<dl class="py class">
<dt id="FromFunctionThrustMagnitudeSettings">
<em class="property">class </em><code class="sig-name descname">FromFunctionThrustMagnitudeSettings</code><a class="headerlink" href="#FromFunctionThrustMagnitudeSettings" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This model defines a thrust force and specific impulse that can vary with time. It requires the following settings as input:</p>
</div></blockquote>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">FromFunctionThrustMagnitudeSettings</span><span class="p">(</span>
         <span class="n">thrustMagnitudeFunction</span><span class="p">,</span> <span class="n">specificImpulseFunction</span><span class="p">,</span>
         <span class="n">isEngineOnFunction</span><span class="p">,</span> <span class="n">bodyFixedThrustDirection</span><span class="p">,</span> <span class="n">customUpdateFunction</span> <span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">thrustMagnitudeFunction</span></code> Thrust magnitude to use (in Newtons), as a function of time as a function of time, defined by a <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">double(</span> <span class="pre">const</span> <span class="pre">double</span> <span class="pre">)</span> <span class="pre">&gt;</span></code>. See below for an example on how to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">specificImpulseFunction</span></code> Specific impulse to use for the thrust as a function of time, defined by a <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">double(</span> <span class="pre">const</span> <span class="pre">double</span> <span class="pre">)</span> <span class="pre">&gt;</span></code>. This quantity is used when applying a mass rate model in the propagation the vehicle dynamics, relating the thrust to the mass decrease of the vehicle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isEngineOnFunction</span></code> Boolean defining whether the thrust should be engaged at all, as a function of time (e.g. thrust is 0 N if it returns false), defined by an <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">bool(</span> <span class="pre">const</span> <span class="pre">double</span> <span class="pre">)</span> <span class="pre">&gt;</span></code>. By default this function always returns true.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bodyFixedThrustDirection</span></code> Body-fixed thrust direction (positive x-direction by default) as a <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">Eigen::Vector3d(</span> <span class="pre">)</span> <span class="pre">&gt;</span></code>. Note that this function should be a unit-vector, and represents the direction opposite to the nozzle direction. This setting can be used to incorporate thrust-vector control (TVC) into the thrust.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">customUpdateFunction</span></code> Function that updates any relevant aspects of the environment/system models, as a <code class="docutils literal notranslate"><span class="pre">std::function&lt;</span> <span class="pre">void(</span> <span class="pre">const</span> <span class="pre">double</span> <span class="pre">)</span></code>, which is called before retrieving the thrust magnitude, specific impulse, and body-fixed thrust direction. By default, no such function is used</p></li>
</ul>
<p>Note that if you wish to use a constant value (as opposed to the <code class="docutils literal notranslate"><span class="pre">std::function</span></code> expression) for any or all of the first three arguments, you can use lambda expression. For instance, for a variable thrust magnitude, but constant specific impulse of 300 s, you can use:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">FromFunctionThrustMagnitudeSettings</span><span class="p">(</span>
         <span class="n">thrustMagnitudeFunction</span><span class="p">,</span> <span class="p">[](</span> <span class="k">const</span> <span class="kt">double</span> <span class="p">){</span> <span class="k">return</span> <span class="mi">300</span><span class="p">;</span> <span class="p">}</span> <span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Where the last two arguments (<code class="docutils literal notranslate"><span class="pre">isEngineOnFunction</span></code> and <code class="docutils literal notranslate"><span class="pre">bodyFixedThrustDirection</span></code>) are omitted and therefore are set to their default values.</p>
<p>Below, we give a simple example of a class that can be used to incorporate TVC into your models. It uses a toy model, in which the thrust vector is rotated along the body-fixed y-axis, with a llinear rate in time.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TVCGuidance</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>

<span class="n">TVCGuidance</span><span class="p">(</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">initialAngle</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">angleRate</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">referenceTime</span> <span class="p">)</span><span class="o">:</span>
   <span class="n">initialAngle_</span><span class="p">(</span> <span class="n">initialAngle</span> <span class="p">),</span> <span class="n">angleRate_</span><span class="p">(</span> <span class="n">angleRate</span> <span class="p">),</span> <span class="n">referenceTime_</span><span class="p">(</span> <span class="n">referenceTime</span> <span class="p">){</span> <span class="p">}</span>

<span class="o">~</span><span class="n">TVCGuidance</span><span class="p">(</span> <span class="p">){</span> <span class="p">}</span>

<span class="kt">void</span> <span class="n">updateGuidance</span><span class="p">(</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">currentTime</span> <span class="p">)</span>
<span class="p">{</span>

   <span class="c1">// Implement your guidance model here, using your specific algorithm</span>
   <span class="kt">double</span> <span class="n">currentThrustAngle</span> <span class="o">=</span> <span class="n">initialAngle_</span> <span class="o">+</span> <span class="n">angleRate_</span> <span class="o">*</span> <span class="p">(</span> <span class="n">currentTime</span> <span class="o">-</span> <span class="n">referenceTime</span> <span class="p">);</span>
   <span class="n">bodyFixedThrustDirection_</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">cos</span><span class="p">(</span> <span class="n">currentThrustAngle</span> <span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">sin</span><span class="p">(</span> <span class="n">currentThrustAngle</span> <span class="p">);</span>

   <span class="c1">// Ensure that direction is a unit vector</span>
   <span class="n">bodyFixedThrustDirection_</span><span class="p">.</span><span class="n">normalize</span><span class="p">(</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span> <span class="n">getBodyFixedThrustDirection</span><span class="p">(</span> <span class="p">)</span>
<span class="p">{</span>
   <span class="k">return</span> <span class="n">bodyFixedThrustDirection_</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">protected</span><span class="o">:</span>

   <span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span> <span class="n">bodyFixedThrustDirection_</span><span class="p">;</span>

   <span class="kt">double</span> <span class="n">initialAngle_</span><span class="p">;</span>

   <span class="kt">double</span> <span class="n">angleRate_</span><span class="p">;</span>

   <span class="kt">double</span> <span class="n">referenceTime_</span><span class="p">;</span>

<span class="p">};</span>
</pre></div>
</div>
<p>A real guidance model will likely depend on the current environment, and will therefore often have a <span class="xref std std-ref">NamedBodyMap</span> as an input to its constructor.</p>
<p>The <a class="reference internal" href="#ThrustMagnitudeSettings" title="ThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustMagnitudeSettings</span></code></a> are then created as follows, with an initial thrust angle of -0.01 radians (at t=86400 s since J2000) and an angle rate 1.0E-6 radians per second:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create TVC guidance object</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span> <span class="n">TVCGuidance</span> <span class="o">&gt;</span> <span class="n">tvcGuidance</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span> <span class="n">TVCGuidance</span> <span class="o">&gt;</span><span class="p">(</span>
   <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0E-6</span><span class="p">,</span> <span class="mf">86400.0</span> <span class="p">);</span>

<span class="c1">// Retrieve required functions from TVC object</span>
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span> <span class="kt">void</span><span class="p">(</span> <span class="k">const</span> <span class="kt">double</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">updateFunction</span> <span class="o">=</span>
   <span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">TVCGuidance</span><span class="o">::</span><span class="n">updateGuidance</span><span class="p">,</span> <span class="n">tvcGuidance</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span> <span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">thrustDirectionFunction</span> <span class="o">=</span>
   <span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">TVCGuidance</span><span class="o">::</span><span class="n">getBodyFixedThrustDirection</span> <span class="p">);</span>

<span class="c1">// Create thrust magnitude settings, with constant thrust magnitude and specific impulse</span>
<span class="kt">double</span> <span class="n">thrustMagnitude</span> <span class="o">=</span> <span class="mf">1.0E3</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">specificImpulse</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span> <span class="n">ThrustMagnitudeSettings</span> <span class="o">&gt;</span> <span class="n">thrustMagnitudeSettings</span> <span class="o">=</span>
   <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span> <span class="n">FromFunctionThrustMagnitudeSettings</span> <span class="o">&gt;</span><span class="p">(</span>
      <span class="p">[</span> <span class="o">=</span> <span class="p">](</span> <span class="k">const</span> <span class="kt">double</span> <span class="p">){</span> <span class="k">return</span> <span class="n">thrustMagnitude</span><span class="p">;</span> <span class="p">},</span>
      <span class="p">[</span> <span class="o">=</span> <span class="p">](</span> <span class="k">const</span> <span class="kt">double</span> <span class="p">){</span> <span class="k">return</span> <span class="n">specificImpulse</span><span class="p">;</span> <span class="p">},</span>
      <span class="p">[</span> <span class="p">](</span> <span class="k">const</span> <span class="kt">double</span> <span class="p">){</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span> <span class="p">},</span>
      <span class="n">thrustDirectionFunction</span><span class="p">,</span>
      <span class="n">updateFunction</span> <span class="p">);</span>
</pre></div>
</div>
<p>Note that we use a constant thrust magnitude (1 kN) and specific impulse (300 s) here, and focus the example on showing how to incorporate variable body-fixed thrust direction. If so desired, the above could also be used for variable thrust mangitude/specific impulse, by modifying any guidance class(es).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can combined thrust and aerodynamic guidance, by implementing any required thrust guidance functions into your own custom derived class of <a class="reference internal" href="aerodynamicGuidance.html#AerodynamicGuidance" title="AerodynamicGuidance"><code class="xref py py-class docutils literal notranslate"><span class="pre">AerodynamicGuidance</span></code></a></p>
</div>
<dl class="py class">
<dt id="FromBodyThrustMagnitudeSettings">
<em class="property">class </em><code class="sig-name descname">FromBodyThrustMagnitudeSettings</code><a class="headerlink" href="#FromBodyThrustMagnitudeSettings" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>A <a class="reference internal" href="../environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object may be endowed with a <code class="xref py py-class docutils literal notranslate"><span class="pre">VehicleSystems</span></code> property, which defines the suite of hardware that it carries. One of the systems that may be defined in the <code class="xref py py-class docutils literal notranslate"><span class="pre">VehicleSystems</span></code> object which is a list of <a class="reference internal" href="#EngineModel" title="EngineModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EngineModel</span></code></a> objects (stored in a list). This class creates thrust magnitude settings that use the thrust from one or all of the <a class="reference internal" href="#EngineModel" title="EngineModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EngineModel</span></code></a> objects that a vehicle is endowed with. In such a situation, the thrust direction, force and specific impulse are taken from the <a class="reference internal" href="#EngineModel" title="EngineModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EngineModel</span></code></a>. It requires the following settings:</p>
</div></blockquote>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">FromBodyThrustMagnitudeSettings</span><span class="p">(</span>
         <span class="n">useAllEngines</span><span class="p">,</span> <span class="n">thrustOrigin</span> <span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">useAllEngines</span></code> A <code class="docutils literal notranslate"><span class="pre">bool</span></code> defining whether all engines (i.e. all entries in the <code class="docutils literal notranslate"><span class="pre">engineModels</span></code> member of the <code class="xref py py-class docutils literal notranslate"><span class="pre">VehicleSystems</span></code> object in the vehicle’s <a class="reference internal" href="../environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object) are to be used, or only a single engine.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thrustOrigin</span></code> A <code class="docutils literal notranslate"><span class="pre">std::string</span></code> with the name of the engine that is to be used for the thrust (to be empty if useAllEngines is true)</p></li>
</ul>
<dl class="py class">
<dt id="EngineModel">
<em class="property">class </em><code class="sig-name descname">EngineModel</code><a class="headerlink" href="#EngineModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Class in which the model of the engine is saved. Settings similar to those in the previous two thrust magnitude settings may be stored. However, using the interface with an engine model allows a more integrated systems/trajectory simulation to be performed, with applications in e.g. MDO. It allows multiple engine models, each with their own properties, to be defined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently this class in under development, note that this is still a priliminary version.</p>
</div>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../propagationSetup/index.html" class="btn btn-neutral float-right" title="3. Simulator Set-Up" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aerodynamicGuidance.html" class="btn btn-neutral" title="2.4. Aerodynamic Guidance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });
    });
</script>


</body>
</html>