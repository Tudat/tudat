

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.1. Setting up the Environment &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../../index.html"/>
        <link rel="up" title="1. Environment Set-up" href="index.html"/>
        <link rel="next" title="1.2. Available Settings for the Environment Models" href="availableSettings.html"/>
        <link rel="prev" title="1. Environment Set-up" href="index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../applicationWalkthroughs/index.html">Application Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Tudat Libraries</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">1. Environment Set-up</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">1.1. Setting up the Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="availableSettings.html">1.2. Available Settings for the Environment Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="duringPropagation.html">1.3. The Environment During Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tabulatedAtmosphere.html">1.4. Tabulated Atmosphere Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="aerodynamicCoefficients.html">1.5. Aerodynamic Coefficients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../accelerationSetup/index.html">2. Setting up State Derivative Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../propagationSetup/index.html">3. Simulator Set-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../estimationSetup/index.html">4. Estimation Set-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../astroTools/index.html">5. Basic Astrodynamics Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lowThrustTrajectoryDesign/index.html">Low-Thrust Trajectory Design Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mathTools/index.html">6. Basic Mathematics Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../otherLibraries/index.html">7. Other Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="../index.html">Tudat Libraries</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">1. </span>Environment Set-up</a> &raquo;</li>
        
      <li><span class="section-number">1.1. </span>Setting up the Environment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/tutorials/tudatFeatures/environmentSetup/setup.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setting-up-the-environment">
<span id="tudatfeaturesenvironmentsetup"></span><h1><span class="section-number">1.1. </span>Setting up the Environment<a class="headerlink" href="#setting-up-the-environment" title="Permalink to this headline">¶</a></h1>
<p>In Tudat, the physical environment is defined by a list of <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects, each of which represents either a celestial body, or a manmade vehicle. Consequently, all properties that are required for computing e.g. accelerations are stored in <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects.</p>
<p>Tudat provides the following options for environment models:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ephemeris:</strong> defines the state of the body as a function of time (Dynamical Barycentric Time seconds since J2000 is default).</p></li>
<li><p><strong>Gravity field:</strong> defines the gravity field of the body, in terms of its gravitational potential and associated quantities.</p></li>
<li><p><strong>Time-variations of the gravity field:</strong> defines models for the time-dependency of this gravity field.</p></li>
<li><p><strong>Atmosphere model:</strong> defines the atmospheric properties (density, temperature, etc.) as a function of relative position and time</p></li>
<li><p><strong>Shape model:</strong> defines the shape of a body, from which for instance the altitude of another body can be computed</p></li>
<li><p><strong>Rotation model:</strong> defines the instantaneous rotation matrix (and its time derivative) of the body-fixed frame, w.r.t. some inertial frame.</p></li>
<li><p><strong>Aerodynamic coefficient interface:</strong> defines the aerodynamic properties of the body, such as its aerodynamic coeficients as a function of some set of independent variables.</p></li>
<li><p><strong>Radiation pressure interface:</strong> defines the radiation pressure properties of the body.</p></li>
<li><p><strong>Mass model:</strong> defines the mass of a body (possibly as a function of time). This separate function is typically used for vehicles only. For celestial bodies, the mass is typically derived from the gravity field member (if applicable).</p></li>
<li><p><strong>Vehicle system models:</strong> This is a container object that stores properties of systems and physical properties of a vehicle. The options in this container are presently limited to propulsion systems and some physical characteristics related to entry heating.</p></li>
</ul>
</div></blockquote>
<p>These properties can be set manually or default settings can be used (see below).</p>
<dl class="py class">
<dt class="sig sig-object py" id="Body">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Body</span></span><a class="headerlink" href="#Body" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for all properties of a body required for computing e.g. accelerations.</p>
</dd></dl>

<p>Typically the entire environment is stored in a named list of <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object, the standard typedef for which is the <a class="reference internal" href="#NamedBodyMap" title="NamedBodyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedBodyMap</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="NamedBodyMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NamedBodyMap</span></span><a class="headerlink" href="#NamedBodyMap" title="Permalink to this definition">¶</a></dt>
<dd><p>An unordered map of shared pointers to <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects, see <a class="reference internal" href="../../basics/externalLibraries/utility.html#externalutility"><span class="std std-ref">this</span></a> wiki page for a discussion of shared pointers; don’t worry if you’re not sure what a shared pointer or unordered map is at this point.</p>
</dd></dl>

<div class="section" id="creating-the-environment-from-bodysettings">
<span id="tudatfeaturescreatingtheenvironment"></span><h2><span class="section-number">1.1.1. </span>Creating the environment from <a class="reference internal" href="#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a><a class="headerlink" href="#creating-the-environment-from-bodysettings" title="Permalink to this headline">¶</a></h2>
<p>Manually creating all objects defining the full environment is possible (see below), but not recommended. In particular, various environment models are interdependent and these dependencies must be fully and consistently defined for the code to function properly. To this end, we provide a <a class="reference internal" href="#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a> object, which is the easiest way to create a set of (natural or artificial) bodies in Tudat.</p>
<dl class="py class">
<dt class="sig sig-object py" id="BodySettings">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BodySettings</span></span><a class="headerlink" href="#BodySettings" title="Permalink to this definition">¶</a></dt>
<dd><p>Class in which the general properties of each environment model can be set (see above for the list of the available types of environment models). We note that for <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects that represent vehicles, the manual creation is typically used, as the vehicle conditions may depend on the celestial bodies, but not vice versa.</p>
</dd></dl>

<p>In many cases, default properties of (celestial) bodies may be used by calling the <code class="docutils literal notranslate"><span class="pre">getDefaultBodySettings</span></code> function, so that the user does not need to define all required properties line-by-line. At present, the following default settings are used (none if not in list):</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ephemeris:</strong> Tabulated ephemeris created from Spice (valid in the interval that is specified by the input time-arguments to getDefaultBodySettings).</p></li>
<li><p><strong>Gravity field models:</strong> Point mass gravity field models, with gravitational parameter from Spice (if available). Exceptions are the Earth and Moon, for which the EGM96 and GGLP spherical harmonic gravity fields are loaded, respectively.</p></li>
<li><p><strong>Rotation model:</strong> For a given body (if available) the Spice rotation model, with ECLIPJ2000 as base frame, and for a body AAA frame IAU_AAA as target frame (the standard body-fixed frame for each body in Spice).</p></li>
<li><p><strong>Atmosphere model:</strong> 1976 US Standard Atmosphere for Earth (using pregenerated tables). For other bodies, no default shape model is given.</p></li>
<li><p><strong>Shape model:</strong> Spherical model with mean radius obtained from Spice (if avaiable).</p></li>
</ul>
</div></blockquote>
<p>The default settings for a body are loaded as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodyNames</span><span class="p">;</span><span class="w"></span>
<span class="n">bodyNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Sun&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Moon&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyNames</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Mars&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">initialEphemerisTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0E7</span><span class="p">;</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">finalEphemerisTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0E7</span><span class="p">;</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5000.0</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BodySettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">            </span><span class="n">getDefaultBodySettings</span><span class="p">(</span><span class="w"> </span><span class="n">bodyNames</span><span class="p">,</span><span class="w"> </span><span class="n">initialEphemerisTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">finalEphemerisTime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The reasons for passing the initial/final time (as well as the ‘buffer’) are discussed in more detail at the end of this page. As can be seen from the above, the settings for the environment are stored in a map of pointers to <a class="reference internal" href="#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a> objects (with the key the name of the associated bodies). If you have a look at the definition of the <a class="reference internal" href="#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a> class (in <code class="docutils literal notranslate"><span class="pre">SimulationSetup/createBodies.h</span></code>), you will see that this type is simply a container for a list of specific environment settings, which we discuss in more detail below. As a result, specifying settings for a given type of environment model requires the creation of an object of the correct type of class (derived class of <a class="reference internal" href="availableSettings.html#EphemerisSettings" title="EphemerisSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">EphemerisSettings</span></code></a> for defining an ephemeris; derived class of <a class="reference internal" href="availableSettings.html#BodyShapeSettings" title="BodyShapeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodyShapeSettings</span></code></a> for defining a body shape etc.)</p>
<p>Often, one will wish to load the default settings, but make slight modifications or additions to it before creating the <a class="reference internal" href="#NamedBodyMap" title="NamedBodyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedBodyMap</span></code></a>. This can be achieved as follows for the example of a shape model: we want an oblate spheroid shape model instead of a spherical shape model for Earth.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodySettings</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">shapeModelSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">OblateSphericalBodyShapeSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">6378.0E3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>which changes the shape model settings of the Earth from the default spherical to the oblate spheroid. A list of available environment models, as well as the manner in which to provide settings for them, is provided at the end of this tutorial. The above appproach is identical for adding or modifying environment model settings (that is, it does not matter whether Earth already had <code class="docutils literal notranslate"><span class="pre">shapeModelSettings</span></code> or not). Once the settings for the environment model have been defined, the following creates the actual <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects and all associated environment models</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NamedBodyMap</span><span class="w"> </span><span class="n">bodyMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBodies</span><span class="p">(</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>It should be noted that default settings presently exist only for celestial bodies. The addition of objects to represent vehicles may be done either at the settings level (appending the <code class="docutils literal notranslate"><span class="pre">bodySettings</span></code> map) or at the body object level (appending the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code>). Here, we give the example of directly appending the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code>. For instance, creating an Apollo entry vehicle object, and adding a mass and aerodynamic properties is achieved as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">setAerodynamicCoefficientInterface</span><span class="p">(</span><span class="w"> </span><span class="n">getApolloCoefficientInterface</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">setConstantBodyMass</span><span class="p">(</span><span class="w"> </span><span class="mf">5.0E3</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">getApolloCoefficientInterface</span></code> is a predefined function that generates an aerodynamic database from the Apollo capsule’s shape. A final, but crucial step in creating the bodyMap is the following:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">setGlobalFrameBodyEphemerides</span><span class="p">(</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SSB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ECLIPJ2000&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This line of code allows the ephemerides and rotation models of the various bodies to be defined w.r.t. different origins (and even w.r.t. each other).</p>
</div>
<div class="section" id="manually-creating-the-environment">
<h2><span class="section-number">1.1.2. </span>Manually creating the environment<a class="headerlink" href="#manually-creating-the-environment" title="Permalink to this headline">¶</a></h2>
<p>The following shows how to manually declare a <a class="reference internal" href="#NamedBodyMap" title="NamedBodyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedBodyMap</span></code></a>, and then create entries in this body map for a number of bodies:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NamedBodyMap</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">;</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Moon&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Sun&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This creates four body objects (representing three celestial bodies and one vehicle; Tudat does not distinguish between the two). However, these bodies do not yet have any physical properties, the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code> created above now only indicates the existence of these four bodies.</p>
<p>To actually define the physical properties of the environment, a <a class="reference internal" href="#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object may be endowed with any of a number of properties. In particular, the following properties may be set. A more extensive list of possible model types is given at the end of this tutorial page:</p>
<p>For instance, to manually create and set an ephemeris (from Spice w.r.t. the barycenter) and gravity field (point-mass only) object in the <code class="docutils literal notranslate"><span class="pre">&quot;Earth&quot;</span></code> entry of the body map, the following can be used:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">setEphemeris</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SpiceEphemeris</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SSB&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;J2000&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">setGravityFieldModel</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">GravityFieldModel</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">3.986004418E14</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This calls the constructors of the <a class="reference internal" href="../otherLibraries/spice.html#SpiceEphemeris" title="SpiceEphemeris"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpiceEphemeris</span></code></a> and <a class="reference internal" href="availableSettings.html#GravityFieldModel" title="GravityFieldModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GravityFieldModel</span></code></a> classes, and assigns the objects that are constructed to the “Earth” entry of the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code>.</p>
</div>
<div class="section" id="valid-time-range-of-environment">
<h2><span class="section-number">1.1.3. </span>Valid Time-Range of Environment<a class="headerlink" href="#valid-time-range-of-environment" title="Permalink to this headline">¶</a></h2>
<p>Most of the environment models are valid for any time, but there is a key exception. In particular, the default settings do not directly use the Spice ephemerides, but retrieve the state for each body from Spice, and then create a <code class="xref py py-class docutils literal notranslate"><span class="pre">TabulatedEphemeris</span></code> (which is only valid in the given time range, of which settings are explained in <a class="reference internal" href="availableSettings.html#TabulatedEphemerisSettings" title="TabulatedEphemerisSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">TabulatedEphemerisSettings</span></code></a>), as opposed to a <a class="reference internal" href="../otherLibraries/spice.html#SpiceEphemeris" title="SpiceEphemeris"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpiceEphemeris</span></code></a> (as discussed in <a class="reference internal" href="availableSettings.html#DirectSpiceEphermerisSettings" title="DirectSpiceEphermerisSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectSpiceEphermerisSettings</span></code></a>), which is valid for the entire time interval that the Spice kernels contain data. This approach is taken for computational reasons: retrieving a state from Spice is very time-consuming, much more so than retrieving it from a 6th- or 8th-order Lagrange interpolator that is used here for the tabulated ephemeris. An additional consequence of this is that the start and end time of the environment must be slightly (3 times the integration time step) larger than that which is used for the actual propagation, as a Lagrange interpolator can be unreliable at the edges of its domain. It is also possible to use the <a class="reference internal" href="../otherLibraries/spice.html#SpiceEphemeris" title="SpiceEphemeris"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpiceEphemeris</span></code></a> directly, at the expense of longer runtimes, by creating the <code class="docutils literal notranslate"><span class="pre">bodySettings</span></code> and <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code> as:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BodySettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getDefaultBodySettings</span><span class="p">(</span><span class="w"> </span><span class="n">bodiesToCreate</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="n">NamedBodyMap</span><span class="w"> </span><span class="n">bodyMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBodies</span><span class="p">(</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="availableSettings.html" class="btn btn-neutral float-right" title="1.2. Available Settings for the Environment Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="1. Environment Set-up" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>⚠️ This website is now mostly outdated! ⚠️</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>