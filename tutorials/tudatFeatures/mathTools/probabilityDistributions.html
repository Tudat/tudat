

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.3. Probability Distributions &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../../index.html"/>
        <link rel="up" title="6. Basic Mathematics Tools" href="index.html"/>
        <link rel="next" title="6.4. Filters" href="filters.html"/>
        <link rel="prev" title="6.2. Integrators" href="integrators.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../applicationWalkthroughs/index.html">Application Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Tudat Libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../environmentSetup/index.html">1. Environment Set-up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accelerationSetup/index.html">2. Setting up State Derivative Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../propagationSetup/index.html">3. Simulator Set-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../estimationSetup/index.html">4. Estimation Set-Up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../astroTools/index.html">5. Basic Astrodynamics Tools</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">6. Basic Mathematics Tools</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="interpolators.html">6.1. Interpolators</a></li>
<li class="toctree-l4"><a class="reference internal" href="integrators.html">6.2. Integrators</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">6.3. Probability Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="filters.html">6.4. Filters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../otherLibraries/index.html">7. Other Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="../index.html">Tudat Libraries</a> &raquo;</li>
        
          <li><a href="index.html">6. Basic Mathematics Tools</a> &raquo;</li>
        
      <li>6.3. Probability Distributions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/tutorials/tudatFeatures/mathTools/probabilityDistributions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="probability-distributions">
<span id="tudatfeaturesprobabilitydistributions"></span><h1>6.3. Probability Distributions<a class="headerlink" href="#probability-distributions" title="Permalink to this headline">¶</a></h1>
<p>In Tudat, we have a number of options related to the use of probability distributions, as well as the generation of random variables from these probability distributions. Many of these distributions are taken from the Boost libraries, some we have implemented ourselves.</p>
<div class="section" id="implementation-of-a-probability-distribution">
<h2>6.3.1. Implementation of a Probability Distribution<a class="headerlink" href="#implementation-of-a-probability-distribution" title="Permalink to this headline">¶</a></h2>
<p>To represent a probability distribution with a given probability distribution function (PDF) and associated cumulative distribution function (CDF), we have defined the <code class="xref py py-class docutils literal"><span class="pre">ContinuousProbabilityDistribution</span></code> base class. From this class, we have two ‘branched’ of derived classes:</p>
<blockquote>
<div><ul class="simple">
<li>One set for which we can compute the inverse CDF (with derived class <code class="xref py py-class docutils literal"><span class="pre">InvertibleContinuousProbabilityDistribution</span></code>).</li>
<li>One set for which we cannot compute the inverse CDF.</li>
</ul>
</div></blockquote>
<p>Computing the inverse CDF is needed to generate random variables (discussed below), so that random variables can only be drawn from those distributions of the first category. In most cases, a probability distribution of one of the following types will be sufficient, each of which is implemented in boost:</p>
<blockquote>
<div><ul class="simple">
<li>Uniform distribution</li>
<li>Normal (Gaussian) distribution</li>
<li>Exponential distribution</li>
<li>Gamma distribution</li>
<li>Lognormal distribution</li>
<li>Beta distribution</li>
</ul>
</div></blockquote>
<p>Each of these distributions can be create through the same Tudat interface. Below we given an example of creating a uniform distribution with bounds at -1 and 2.5:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">statistics</span><span class="p">;</span>

<span class="c1">// Define properties of distribution</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">double</span> <span class="o">&gt;</span> <span class="n">parameters</span><span class="p">;</span>
<span class="n">parameters</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="o">-</span><span class="mf">1.0</span> <span class="p">);</span>
<span class="n">parameters</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="mf">2.5</span> <span class="p">);</span>

<span class="c1">// Create distribution</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span> <span class="n">InvertibleContinuousProbabilityDistribution</span><span class="o">&lt;</span> <span class="kt">double</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">probabilityDistribution</span> <span class="o">=</span>
        <span class="n">createBoostRandomVariable</span><span class="p">(</span> <span class="n">uniform_boost_distribution</span><span class="p">,</span> <span class="n">parameters</span> <span class="p">);</span>
</pre></div>
</div>
<p>where the <code class="docutils literal"><span class="pre">probabilityDistribution</span></code> object is created by the <code class="docutils literal"><span class="pre">createBoostRandomVariable</span></code> function, which takes two inputs:</p>
<blockquote>
<div><ul class="simple">
<li>The type of probability distribution variable, defined by a Tudat-defined enumeration (all the options are listed below).</li>
<li>A list of parameters that define the properties of the distribution.</li>
</ul>
</div></blockquote>
<p>The <code class="xref py py-class docutils literal"><span class="pre">InvertibleContinuousProbabilityDistribution</span></code> probability distribution comes with three functions that you can used:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal"><span class="pre">evaluatePdf</span></code> function, giving the PDF at a given point in sample space.</li>
<li>The <code class="docutils literal"><span class="pre">evaluateCdf</span></code> function, giving the CDF at a given point in sample space.</li>
<li>The <code class="docutils literal"><span class="pre">evaluateInverseCdf</span></code> function, giving the point in sample space for a given CDF values (which must be between 0 and 1). Note that this is also referred to as a quantile function.</li>
</ul>
</div></blockquote>
<p>For instance, we can perform the following:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">localPdf</span> <span class="o">=</span> <span class="n">probabilityDistribution</span><span class="o">-&gt;</span><span class="n">evaluatePdf</span><span class="p">(</span> <span class="mf">1.6</span> <span class="p">);</span>
<span class="kt">double</span> <span class="n">localCdf</span> <span class="o">=</span> <span class="n">probabilityDistribution</span><span class="o">-&gt;</span><span class="n">evaluateCdf</span><span class="p">(</span> <span class="mf">1.6</span> <span class="p">);</span>
<span class="kt">double</span> <span class="n">samplePoint</span> <span class="o">=</span> <span class="n">probabilityDistribution</span><span class="o">-&gt;</span><span class="n">evaluateInverseCdf</span><span class="p">(</span> <span class="mf">0.8</span> <span class="p">);</span>
</pre></div>
</div>
<p>To compute the three quantities listed above.</p>
</div>
<div class="section" id="creating-probability-distributions">
<h2>6.3.2. Creating Probability Distributions<a class="headerlink" href="#creating-probability-distributions" title="Permalink to this headline">¶</a></h2>
<p>To create one of the 6 distributions listed above, for each of which the invertible CDF can be computed, call the <code class="docutils literal"><span class="pre">createBoostRandomVariable</span></code> with the following input:</p>
<blockquote>
<div><ul>
<li><p class="first"><strong>Uniform distribution</strong></p>
<blockquote>
<div><ul>
<li><p class="first">First argument: <code class="docutils literal"><span class="pre">uniform_boost_distribution</span></code></p>
</li>
<li><p class="first">Second argument: vector containing (in order):</p>
<blockquote>
<div><ol class="arabic simple">
<li>Lower bound of interval for distribution</li>
<li>Upper bound of interval for distribution</li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Normal distribution</strong></p>
<blockquote>
<div><ul>
<li><p class="first">First argument: <code class="docutils literal"><span class="pre">normal_boost_distribution</span></code></p>
</li>
<li><p class="first">Second argument: vector containing (in order):</p>
<blockquote>
<div><ol class="arabic simple">
<li>Mean (<span class="math">\(\mu\)</span>) of distribution</li>
<li>Standard deviation (<span class="math">\(\sigma\)</span>) of distribution</li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Exponential distribution</strong></p>
<blockquote>
<div><ul>
<li><p class="first">First argument: <code class="docutils literal"><span class="pre">exponential_boost_distribution</span></code></p>
</li>
<li><p class="first">Second argument: vector containing (in order):</p>
<blockquote>
<div><ol class="arabic simple">
<li><span class="math">\(\lambda\)</span> parameter of exponential distribution</li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Gamma distribution</strong></p>
<blockquote>
<div><ul>
<li><p class="first">First argument: <code class="docutils literal"><span class="pre">gamma_boost_distribution</span></code></p>
</li>
<li><p class="first">Second argument: vector containing (in order):</p>
<blockquote>
<div><ol class="arabic simple">
<li>shape (<span class="math">\(k\)</span>) parameter of distribution</li>
<li>scale (<span class="math">\(\theta\)</span>) parameter of distribution</li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Lognormal distribution</strong></p>
<blockquote>
<div><ul>
<li><p class="first">First argument: <code class="docutils literal"><span class="pre">lognormal_boost_distribution</span></code></p>
</li>
<li><p class="first">Second argument: vector containing (in order):</p>
<blockquote>
<div><ol class="arabic simple">
<li>location (<span class="math">\(\mu\)</span>) parameter of distribution</li>
<li>scale (<span class="math">\(\sigma\)</span>) parameter of distribution</li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Beta distribution</strong></p>
<blockquote>
<div><ul>
<li><p class="first">First argument: <code class="docutils literal"><span class="pre">beta_boost_distribution</span></code></p>
</li>
<li><p class="first">Second argument: vector containing (in order):</p>
<blockquote>
<div><ol class="arabic simple">
<li><span class="math">\(\alpha\)</span> parameter of distribution</li>
<li><span class="math">\(\beta\)</span> parameter of distribution</li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>A number of multivariate distributions are also available in Tudat. These are:</p>
<blockquote>
<div><ul class="simple">
<li>Multivariate Gaussian distribution.</li>
<li>Gaussian Cupola distrbution.</li>
</ul>
</div></blockquote>
<p>For more information on these distributions, you are referred to the&nbsp;in-code Doxygen documentation. Note that only a pdf can be evaluated for these distributions. Also, a Kernel density distribution for multi-variate data is available, see the&nbsp;in-code Doxygen documentation. Note that only a pdf and cdf (no inverse cdf) can be evaluated for this distribution.</p>
</div>
<div class="section" id="generation-of-random-numbers">
<h2>6.3.3. Generation of Random Numbers<a class="headerlink" href="#generation-of-random-numbers" title="Permalink to this headline">¶</a></h2>
<p>For each of the invertible random variables described above, you can easily create a random number generator which generates variables according to that distribution. For the 6 boost distributions listed above, you can use the same input (type and parameters) as listed above. We provide two interfaces for random variable generation:</p>
<blockquote>
<div><ul class="simple">
<li>A class <code class="xref py py-class docutils literal"><span class="pre">ContinuousRandomVariableGenerator</span></code>, with a <code class="docutils literal"><span class="pre">getRandomVariableValue</span></code> that produces random numbers.</li>
<li>A boost function <code class="docutils literal"><span class="pre">std::function&lt;</span> <span class="pre">double(</span> <span class="pre">)</span> <span class="pre">&gt;</span></code> which produces random numbers every time it is called.</li>
</ul>
</div></blockquote>
<p>We illustrate these two options with some examples below.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">statistics</span><span class="p">;</span>

<span class="c1">// Define properties of distribution</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">double</span> <span class="o">&gt;</span> <span class="n">parameters</span><span class="p">;</span>
<span class="n">parameters</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="mf">1.0</span> <span class="p">);</span>
<span class="n">parameters</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="mf">3.2</span> <span class="p">);</span>

<span class="c1">// Create distribution object</span>
<span class="kt">double</span> <span class="n">distributionSeed</span> <span class="o">=</span> <span class="mf">42.0</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span> <span class="n">RandomVariableGenerator</span><span class="o">&lt;</span> <span class="kt">double</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">randomNumberGenerator</span> <span class="o">=</span> <span class="n">createBoostContinuousRandomVariableGenerator</span><span class="p">(</span>
        <span class="n">uniform_boost_distribution</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">distributionSeed</span> <span class="p">);</span>

<span class="c1">// Create distrubution function</span>
<span class="n">distributionSeed</span> <span class="o">=</span> <span class="mf">43.0</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span> <span class="kt">double</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">randomNumberFunction</span> <span class="o">=</span> <span class="n">createBoostContinuousRandomVariableGeneratorFunction</span><span class="p">(</span>
        <span class="n">uniform_boost_distribution</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">distributionSeed</span> <span class="p">);</span>

<span class="c1">// Generate random variables</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">double</span> <span class="o">&gt;</span> <span class="n">randomVariables1</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="kt">double</span> <span class="o">&gt;</span> <span class="n">randomVariables2</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mf">1E6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">randomVariables1</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">randomNumberGenerator</span><span class="o">-&gt;</span><span class="n">getRandomVariableValue</span><span class="p">(</span> <span class="p">)</span> <span class="p">);</span>
    <span class="n">randomVariables2</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">randomNumberFunction</span><span class="p">(</span> <span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above creates two vectors give a million doubles, distributed according to a normal distribution with mean of 1 and standard deviation of 3.2.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When creating a random variable generator you must also provide a ‘seed’ value, which initializes the generator. Fixing this value for a given means that the exact same set of random numbers will be generated everytime you run the program.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="filters.html" class="btn btn-neutral float-right" title="6.4. Filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="integrators.html" class="btn btn-neutral" title="6.2. Integrators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });
    });
</script>


</body>
</html>