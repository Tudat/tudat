

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Multi-case Simulations &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../index.html"/>
        <link rel="up" title="JSON Interface" href="index.html"/>
        <link rel="next" title="MATLAB Interface" href="../matlabInterface/index.html"/>
        <link rel="prev" title="5. Modular Files" href="modularFiles.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../applicationWalkthroughs/index.html">Application Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tudatFeatures/index.html">Tudat Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">JSON Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="basicJsonInterfaces.html">1. Basic JSON Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="customJsonApp.html">2. Writing Custom JSON-based Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/index.html">3. Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="keys/rst/index.html">4. List of Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="modularFiles.html">5. Modular Files</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6. Multi-case Simulations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="index.html">JSON Interface</a> &raquo;</li>
        
      <li><span class="section-number">6. </span>Multi-case Simulations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/jsonInterface/multicase.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multi-case-simulations">
<span id="jsoninterface-multicase"></span><h1><span class="section-number">6. </span>Multi-case Simulations<a class="headerlink" href="#multi-case-simulations" title="Permalink to this headline">¶</a></h1>
<p>The JSON Interface allows combining several input files to generate a single object that is used to set up a propagation. This is slightly different than the modular files described in the previous page. In the previous case, during the creation of the root input file, the special strings <code class="docutils literal notranslate"><span class="pre">&quot;$(file.json)&quot;</span></code> were replaced by the contents of the reference file. In this case, the contents of two files are combined, processing first one object and then (re-)defining the keys specified in the second object. This is done by writing, for instance:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">mass8000.json</span></code></span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;$(shared.json)&quot;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nt">&quot;bodies.satellite.mass&quot;</span><span class="p">:</span> <span class="mi">8000</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>The first element of the array is (a reference to a file containing) the settings for the simulation (the file referred to as root or main file so far). Then, the second object is used to (re-)define the values of some keys by providing key paths. For instance, if the contents of the reference file are:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code></span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;bodies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;Earth&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;useDefaultSettings&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="nt">&quot;satellite&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;mass&quot;</span><span class="p">:</span> <span class="mi">5000</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>parsing the file <code class="xref py py-class docutils literal notranslate"><span class="pre">mass8000.json</span></code> will result in the following object:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;bodies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;Earth&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;useDefaultSettings&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="nt">&quot;satellite&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;mass&quot;</span><span class="p">:</span> <span class="mi">8000</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Even when the keys <span class="jsonkey">satellite.mass</span> or <span class="jsonkey">satellite</span> are undefined in <code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code>, the same combined object would be obtained.</p>
<p>This feature is especially useful when running multi-case simulations (for solving optimisation problems), as it allows the user to define the shared settings in a file, that is referenced from mergeable files in which some keys (the optimisation variables) are (re-)defined. In this way, repeating the same information in every file is avoided, which can lead to large file sizes specially for complex propagations or when the number of simulations to be run is large.</p>
<p>For instance, the following tree structure can be used to run the same simulations with a variable value for the mass of the vehicle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">inputs</span>
<span class="o">|</span>      <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass5000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass6000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass7000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass8000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">shared</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Then, the <code class="docutils literal notranslate"><span class="pre">json_interface</span></code> application is called for each of the files inside the <code class="xref py py-class docutils literal notranslate"><span class="pre">inputs</span></code> directory. Note that there is no need to call it for the file <code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code>. If one has <a class="reference external" href="https://www.gnu.org/software/parallel/">GNU Parallel</a> installed, it is possible to run the simulations in parallel by writing in Terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parallel</span> <span class="n">json_interface</span> <span class="p">:::</span> <span class="n">inputs</span><span class="o">/*.</span><span class="n">json</span>
</pre></div>
</div>
<p>Note that the second element of the array to be merged can contain several keys to be (re-)defined, and even more than one object can be provided. For instance, consider the following tree structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">inputs</span>
<span class="o">|</span>      <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">rk4</span>
<span class="o">|</span>      <span class="o">|</span>   <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span>   <span class="o">|</span> <span class="n">mass5000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span>   <span class="o">|</span> <span class="n">mass6000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span>   <span class="o">|</span> <span class="n">mass7000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span>   <span class="o">|</span> <span class="n">mass8000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">rk78</span>
<span class="o">|</span>           <span class="o">|</span>
<span class="o">|</span>           <span class="o">|</span> <span class="n">mass5000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>           <span class="o">|</span> <span class="n">mass6000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>           <span class="o">|</span> <span class="n">mass7000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>           <span class="o">|</span> <span class="n">mass8000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">shared</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span> <span class="n">rk4</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span> <span class="n">rk78</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">rk4.json</span></code></span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;rungeKutta4&quot;</span><span class="p">,</span>
  <span class="nt">&quot;stepSize&quot;</span><span class="p">:</span> <span class="mi">20</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">rk78.json</span></code></span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;rungeKuttaVariableStepSize&quot;</span><span class="p">,</span>
  <span class="nt">&quot;rungeKuttaCoefficientSet&quot;</span><span class="p">:</span> <span class="s2">&quot;rungeKuttaFehlberg78&quot;</span><span class="p">,</span>
  <span class="nt">&quot;initialStepSize&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
  <span class="nt">&quot;minimumStepSize&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;maximumStepSize&quot;</span><span class="p">:</span> <span class="mf">1e4</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Then, each of the mergeable files would look like this:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">inputs/rk4/mass8000.json</span></code></span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;$(../../shared.json)&quot;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nt">&quot;integrator&quot;</span><span class="p">:</span> <span class="s2">&quot;$(../../rk4.json)&quot;</span><span class="p">,</span>
    <span class="nt">&quot;bodies.satellite.mass&quot;</span><span class="p">:</span> <span class="mi">8000</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>It is also possible to use the following integrator file:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">rk4.json</span></code></span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;$(shared.json)&quot;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nt">&quot;integrator&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;rungeKutta4&quot;</span><span class="p">,</span>
      <span class="nt">&quot;stepSize&quot;</span><span class="p">:</span> <span class="mi">20</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>and then</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">inputs/rk4/mass8000.json</span></code></span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;$(../../rk4.json)&quot;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nt">&quot;bodies.satellite.mass&quot;</span><span class="p">:</span> <span class="mi">8000</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>In this case, the <code class="xref py py-class docutils literal notranslate"><span class="pre">mass8000.json</span></code> file is a mergeable file that references another mergeable file. The mergeable <code class="xref py py-class docutils literal notranslate"><span class="pre">rk4.json</span></code> loads first the data defined in <code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code> and then defines the key <span class="jsonkey">integrator</span> to be equal to the provided object (i.e. <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;type&quot;:</span> <span class="pre">&quot;rungeKutta4&quot;,</span> <span class="pre">&quot;stepSize&quot;:</span> <span class="pre">20</span> <span class="pre">}</span></code>). In both cases, the final merged object used to actually set up the simulation will be identical.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Note that the following file would result in a different behaviour:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">inputs/rk4/mass8000.json</span></code></span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;$(../../rk4.json)&quot;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nt">&quot;bodies&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;satellite&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;mass&quot;</span><span class="p">:</span> <span class="mi">8000</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>In this case, the contents of <code class="xref py py-class docutils literal notranslate"><span class="pre">rk4.json</span></code> would be loaded first, and then the property of the key <span class="jsonkey">bodies</span> would be re-defined to be equal to <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;satellite&quot;:</span> <span class="pre">{</span> <span class="pre">&quot;mass&quot;:</span> <span class="pre">8000</span> <span class="pre">}</span> <span class="pre">}</span></code>. This would result in the loss of other keys defined inside <code class="docutils literal notranslate"><span class="pre">bodies.satellite</span></code> and <code class="docutils literal notranslate"><span class="pre">bodies</span></code> in the file <code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code>.</p>
</div>
<p>Generally, we will want to save the results of each simulation (e.g. the epochs and states) to a different file, so that we end up with the following file tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">inputs</span>
<span class="o">|</span>      <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass5000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass6000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass7000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>      <span class="o">|</span> <span class="n">mass8000</span><span class="o">.</span><span class="n">json</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">outputs</span>
<span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span> <span class="n">mass5000</span><span class="o">.</span><span class="n">txt</span>
<span class="o">|</span>       <span class="o">|</span> <span class="n">mass6000</span><span class="o">.</span><span class="n">txt</span>
<span class="o">|</span>       <span class="o">|</span> <span class="n">mass7000</span><span class="o">.</span><span class="n">txt</span>
<span class="o">|</span>       <span class="o">|</span> <span class="n">mass8000</span><span class="o">.</span><span class="n">txt</span>
<span class="o">|</span>
<span class="o">|</span> <span class="n">shared</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>We can do this by defining the key <span class="jsonkey">export</span> in the <code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code> file:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code></span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;export&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;variables&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;independent&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;state&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>and then, in each file inside the <code class="xref py py-class docutils literal notranslate"><span class="pre">inputs</span></code> directory, we would have to define the file to which the results of that simulation should be saved:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">inputs/mass8000.json</span></code></span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;$(../shared.json)&quot;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="nt">&quot;bodies.satellite.mass&quot;</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span>
    <span class="nt">&quot;export.file&quot;</span><span class="p">:</span> <span class="s2">&quot;@path(../outputs/mass8000.txt)&quot;</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>However, there is a way to avoid having to include this additional line in each of the input files. Before showing how this can be done, it is necessary to define the following concepts:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Declaration file</strong>: file in which a JSON key and corresponding value are defined.</p></li>
<li><p><strong>Parent file</strong>: file from which the declaration file is referenced.</p></li>
<li><p><strong>Root file</strong>: file provided as input argument to the <code class="docutils literal notranslate"><span class="pre">json_interface</span></code> application.</p></li>
</ul>
</div></blockquote>
<p>Then, the following special variables can be used inside strings anywhere in input files, which will be replaced by:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">${FILE_DIR}</span></code>: absolute path of the directory where the declaration file is located.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${FILE_STEM}</span></code>: filename (without extension) of the declaration file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${FILE_NAME}</span></code>: filename (with extension) of the declaration file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${PARENT_FILE_DIR}</span></code>: absolute path of the directory where the parent file is located.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${PARENT_FILE_STEM}</span></code>: filename (without extension) of the parent file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${PARENT_FILE_NAME}</span></code>: filename (with extension) of the parent file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${ROOT_FILE_DIR}</span></code>: absolute path of the directory where the root file is located.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${ROOT_FILE_STEM}</span></code>: filename (without extension) of the root file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${ROOT_FILE_NAME}</span></code>: filename (with extension) of the root file.</p></li>
</ul>
</div></blockquote>
<p>For instance, we can remove the line <code class="docutils literal notranslate"><span class="pre">export.file</span> <span class="pre">=</span> <span class="pre">...</span></code> from each of the individual input files by writing in the shared file:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text"><code class="xref py py-class docutils literal notranslate"><span class="pre">shared.json</span></code></span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;export&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;variables&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;independent&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;state&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;@path(outputs/${ROOT_FILE_STEM}.txt)&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>When running <code class="docutils literal notranslate"><span class="pre">json_interface</span> <span class="pre">mass8000.json</span></code>, the string <code class="docutils literal notranslate"><span class="pre">&quot;&#64;path(outputs/${ROOT_FILE_STEM}.txt)&quot;</span></code> will be resolved to <code class="docutils literal notranslate"><span class="pre">&quot;../outputs/mass8000.txt&quot;</span></code>. Note that the path, defined relative to the input file in which it was declared, is converted to a path that is relative to the root input file provided to the application as command-line argument (i.e. <code class="xref py py-class docutils literal notranslate"><span class="pre">mass8000.json</span></code>). This is only possible by using <code class="docutils literal notranslate"><span class="pre">&quot;&#64;path(relPath)&quot;</span></code>. If we do not use the <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code> keyword, the JSON parser cannot tell regular strings and paths apart, and in this case that would have resulted in the creation of an <code class="xref py py-class docutils literal notranslate"><span class="pre">outputs</span></code> directory inside the <code class="xref py py-class docutils literal notranslate"><span class="pre">inputs</span></code> directory. In summary:</p>
<blockquote>
<div><ul class="simple">
<li><p>When a path is provided as a plain string (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;relativePath&quot;</span></code>), it must be relative to the root file.</p></li>
<li><p>When a path is provided using the <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code> keyword (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;&#64;path(relativePath)&quot;</span></code>), it must be relative to the declaration file.</p></li>
<li><p>When a special string is used to include (parts of) the contents of another JSON file (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;$(shared.json)&quot;</span></code>), the <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code> keyword is not used and it must be relative to the declaration file.</p></li>
</ul>
</div></blockquote>
<p>It is recommended to never provide relative paths as plain strings, and to always use either <code class="docutils literal notranslate"><span class="pre">&#64;path(</span> <span class="pre">)</span></code> or <code class="docutils literal notranslate"><span class="pre">$(</span> <span class="pre">)</span></code>, so that the paths are always specified relative to the declaration file. When no modular or mergeable files are used, the root file and the definition file are always the same, so using the <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code> keyword makes it unnecessary but still recommended, as the project could be modularised in the future or parts of it may be end up being used in other projects, potentially requiring the use of the <code class="docutils literal notranslate"><span class="pre">&#64;path</span></code> keyword.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../matlabInterface/index.html" class="btn btn-neutral float-right" title="MATLAB Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modularFiles.html" class="btn btn-neutral" title="5. Modular Files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>⚠️ This website is now mostly outdated! ⚠️</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>