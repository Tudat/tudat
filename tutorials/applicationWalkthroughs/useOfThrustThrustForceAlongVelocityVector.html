

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Use of Thrust: Thrust Force Along Velocity Vector &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../index.html"/>
        <link rel="up" title="Application Tutorials" href="index.html"/>
        <link rel="next" title="6. Use of Thrust: User-defined Thrust Vector" href="useOfThrustUserDefinedThrustVector.html"/>
        <link rel="prev" title="4. Inner Solar System Propagation" href="innerSolarSystemPropagation.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Application Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#preparation">Preparation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#tudat-example-application-tutorials">Tudat Example Application Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="unperturbedEarthOrbitingSatellite.html">1. Unperturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="perturbedEarthOrbitingSatellite.html">2. Perturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="unguidedCapsuleEntry.html">3. Un-guided Capsule Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="innerSolarSystemPropagation.html">4. Inner Solar System Propagation</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">5. Use of Thrust: Thrust Force Along Velocity Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustUserDefinedThrustVector.html">6. Use of Thrust: User-defined Thrust Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="tabulatedAtmosphereExamples.html">7. Tabulated Atmosphere Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="propagatorTypesComparison.html">8. Comparison of Propagator Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="filterExample.html">9. Kalman Filter for State Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="variationalEquationsPropagation.html">10. Variational Equations Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterBasicStateEstimation.html">11. Orbit Determination and Parameter Estimation (Basic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterStateEstimation.html">12. Orbit Determination and Parameter Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="interplanetaryTrajectory.html">13. MGA Trajectory Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationCR3BP.html">14. Full propagation of the CR3BP</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationPatchedConicsTrajectory.html">15. Full propagation of a patched conics trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="shapeBasedTrajectory.html">16. Shape-Based Low-Thrust Trajectories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pagmo-optimization-tutorials">Pagmo Optimization Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tudatFeatures/index.html">Tudat Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Application Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Use of Thrust: Thrust Force Along Velocity Vector</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/applicationWalkthroughs/useOfThrustThrustForceAlongVelocityVector.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="use-of-thrust-thrust-force-along-velocity-vector">
<span id="walkthroughsuseofthrustthrustforcealongvelocityvector"></span><h1><span class="section-number">5. </span>Use of Thrust: Thrust Force Along Velocity Vector<a class="headerlink" href="#use-of-thrust-thrust-force-along-velocity-vector" title="Permalink to this headline">Â¶</a></h1>
<p>This example focuses on the inclusion of a thrust force in Tudat. The code for this tutorial is given on Github, and is also located in your Tudat bundle at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tudatBundle</span><span class="o">/</span><span class="n">tudatExampleApplications</span><span class="o">/</span><span class="n">satellitePropagatorExamples</span><span class="o">/</span><span class="n">SatellitePropagatorExamples</span><span class="o">/</span><span class="n">thrustAlongVelocityVectorExample</span><span class="o">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p>Although thrust is in principle handled just like any other force in Tudat, you as a user have much more control over how this thrust behaves. In fact, optimizing the thrust profile is an important goal of many types of simulations. The addition of a thrust force requires the addition of the following blocks of code/information:</p>
<blockquote>
<div><ul class="simple">
<li><p>Definition of thrust direction/magnitude, in many cases as a function of time (or other variables).</p></li>
<li><p>Definition of specific impulse, in some cases as a function of time (or other variables).</p></li>
<li><p>Inclusion of vehicle mass in the state vector: using thrust decreases the mass of the spacecraft, which we propagate concurrently with the translational state.</p></li>
</ul>
</div></blockquote>
<p>A list of options/details of the first two of these points is discussed here. For this example, we will only treat a single type of thrust model, for which:</p>
<blockquote>
<div><ul class="simple">
<li><p>The thrust force and specific impulse are constant.</p></li>
<li><p>The direction of the thrust is always along (and in the same direction as) the vehicleâs Earth-centered velocity vector.</p></li>
</ul>
</div></blockquote>
<p>We will not treat the entire source file for the simulation, as most of it is similar or identical to that discussed in detail in <a class="reference internal" href="unperturbedEarthOrbitingSatellite.html#walkthroughsunperturbedearthorbitingsatellite"><span class="std std-ref">Unperturbed Earth-orbiting Satellite</span></a> and <a class="reference internal" href="perturbedEarthOrbitingSatellite.html#walkthroughsperturbedearthorbitingsatellite"><span class="std std-ref">Perturbed Earth-orbiting Satellite</span></a>.</p>
<div class="section" id="adding-the-thrust-acceleration">
<h2><span class="section-number">5.1. </span>Adding the Thrust Acceleration<a class="headerlink" href="#adding-the-thrust-acceleration" title="Permalink to this headline">Â¶</a></h2>
<p>The first main difference w.r.t. the other examples is the use of a thrust acceleration. For this example, the full code required for this is:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define thrust settings</span>
<span class="kt">double</span><span class="w"> </span><span class="n">thrustMagnitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">25.0</span><span class="p">;</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">specificImpulse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5000.0</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustDirectionGuidanceSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thrustDirectionGuidanceSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustDirectionFromStateGuidanceSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustMagnitudeSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thrustMagnitudeSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ConstantThrustMagnitudeSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">thrustMagnitude</span><span class="p">,</span><span class="w"> </span><span class="n">specificImpulse</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Define acceleration model settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">accelerationsOfVehicle</span><span class="p">;</span><span class="w"></span>
<span class="n">accelerationsOfVehicle</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Vehicle&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustAccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">thrustDirectionGuidanceSettings</span><span class="p">,</span><span class="w"> </span><span class="n">thrustMagnitudeSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>First, we define a constant thrust force of 25 N and specific impulse of 5000 s. For the interface of the thrust we use here, two blocks need to be defined before creating the <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#AccelerationSettings" title="AccelerationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">AccelerationSettings</span></code></a>, one providing settings for the direction, and one for the magnitude of the thrust force.</p>
<p>The direction settings are defined by an object of type (derived from) <a class="reference internal" href="../tudatFeatures/accelerationSetup/thrustModels.html#ThrustDirectionGuidanceSettings" title="ThrustDirectionGuidanceSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustDirectionGuidanceSettings</span></code></a>. For this example, we use a derived class designed specifically to set the thrust in the direction of the vehicle velocity vector. Please go to <a class="reference internal" href="../tudatFeatures/accelerationSetup/thrustModels.html#tudatfeaturesthrustmodels"><span class="std std-ref">Thrust Guidance</span></a> for the other options for the direction settings:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustDirectionGuidanceSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thrustDirectionGuidanceSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustDirectionFromStateGuidanceSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The three input arguments to the constructor of the <a class="reference internal" href="../tudatFeatures/accelerationSetup/thrustModels.html#ThrustDirectionFromStateGuidanceSettings" title="ThrustDirectionFromStateGuidanceSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustDirectionFromStateGuidanceSettings</span></code></a> represent:</p>
<blockquote>
<div><ul class="simple">
<li><p>The central body w.r.t. which the velocity is to be computed when setting the thrust direction. For instance, the propagation of a vehicle may be done w.r.t. the Sun, while the thrust direction is computed from the velocity w.r.t. the Earth.</p></li>
<li><p>Whether the thrust is colinear with velocity (true) or position (false) w.r.t. the central body.</p></li>
<li><p>Whether the thrust force is in the same direction (false), or opposite to the direction (true), of the state of the vehicle w.r.t. the central body.</p></li>
</ul>
</div></blockquote>
<p>We have set the thrust force to be in line and in the same direction as the velocity vector of the spacecraft w.r.t. the Earth. Defining the magnitude of the thrust (and specific impulse) is done through the dedicated derived class <a class="reference internal" href="../tudatFeatures/accelerationSetup/thrustModels.html#ConstantThrustMagnitudeSettings" title="ConstantThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantThrustMagnitudeSettings</span></code></a>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustMagnitudeSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thrustMagnitudeSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ConstantThrustMagnitudeSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">thrustMagnitude</span><span class="p">,</span><span class="w"> </span><span class="n">specificImpulse</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>with the first and second arguments of the <a class="reference internal" href="../tudatFeatures/accelerationSetup/thrustModels.html#ConstantThrustMagnitudeSettings" title="ConstantThrustMagnitudeSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantThrustMagnitudeSettings</span></code></a> represent the constant thrust force and specific impulse. Now, the thrust acceleration settings are added to the <code class="docutils literal notranslate"><span class="pre">accelerationsOfVehicle</span></code> list as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">accelerationsOfVehicle</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Vehicle&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ThrustAccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">thrustDirectionGuidanceSettings</span><span class="p">,</span><span class="w"> </span><span class="n">thrustMagnitudeSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>where you can see that defining a thrust acceleration requires a dedicated derived class of <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#AccelerationSettings" title="AccelerationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">AccelerationSettings</span></code></a>. This derived class <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#ThrustAccelerationSettings" title="ThrustAccelerationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustAccelerationSettings</span></code></a> takes the settings for the magnitude and direction of the thrust force, which we just created, as input. A final point to remember when defining the <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#ThrustAccelerationSettings" title="ThrustAccelerationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThrustAccelerationSettings</span></code></a> is that thrust is a force that the vehicle exerts on itself.</p>
</div>
<div class="section" id="propagating-the-mass-and-the-orbit">
<h2><span class="section-number">5.2. </span>Propagating the Mass and the Orbit<a class="headerlink" href="#propagating-the-mass-and-the-orbit" title="Permalink to this headline">Â¶</a></h2>
<p>For consistent simulation results, the mass decrease as a result of the expelled propellant must be included in the simulation. Doing so requires a significant modification of the way in which the propagator settings are defined. The total block of code is:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define propagation termination conditions (stop after 2 weeks).</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PropagationTimeTerminationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">propagators</span><span class="o">::</span><span class="n">PropagationTimeTerminationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">14.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">physical_constants</span><span class="o">::</span><span class="n">JULIAN_DAY</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Define settings for propagation of translational dynamics.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TranslationalStatePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">translationalPropagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TranslationalStatePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">centralBodies</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="p">,</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">systemInitialState</span><span class="p">,</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create mass rate models</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">MassRateModelSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">massRateModelSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">FromThrustMassModelSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">MassRateModel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">massRateModels</span><span class="p">;</span><span class="w"></span>
<span class="n">massRateModels</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Vehicle&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createMassRateModel</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="s">&quot;Vehicle&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">massRateModelSettings</span><span class="p">,</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create settings for propagating the mass of the vehicle.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodiesWithMassToPropagate</span><span class="p">;</span><span class="w"></span>
<span class="n">bodiesWithMassToPropagate</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Vehicle&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">initialBodyMasses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">initialBodyMasses</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vehicleMass</span><span class="p">;</span><span class="w"></span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleArcPropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">massPropagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">MassPropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">bodiesWithMassToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">massRateModels</span><span class="p">,</span><span class="w"> </span><span class="n">initialBodyMasses</span><span class="p">,</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create list of propagation settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleArcPropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">propagatorSettingsVector</span><span class="p">;</span><span class="w"></span>
<span class="n">propagatorSettingsVector</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">translationalPropagatorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">propagatorSettingsVector</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">massPropagatorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create propagation settings for mass and translational dynamics concurrently</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">propagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">MultiTypePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">propagatorSettingsVector</span><span class="p">,</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The first line explicitly creates the object defining the termination conditions of the propagation.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PropagationTimeTerminationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">propagators</span><span class="o">::</span><span class="n">PropagationTimeTerminationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">14.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">physical_constants</span><span class="o">::</span><span class="n">JULIAN_DAY</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This is similar to the step we took in a previous example, but distinct from the first two examples, where we simply passed the final time variable as a double to the constructor of our propagation settings. Please go to <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettingsTermination.html#tudatfeaturespropagatorsettingstermination"><span class="std std-ref">Propagator Settings: Termination Settings</span></a> for further details on termination settings.</p>
<p>In the next step, we create the propagation settings for the translational dynamics, in the same way as is done in the previous examples. To incorporate the change in vehicle mass, we need to create mass rate models, which are essentially the equivalent of accelelations for âmass dynamicsâ. They compute the time derivative of the mass at each time step. Defining the settings for these models is done by creating objects of class (derived from) <a class="reference internal" href="../tudatFeatures/accelerationSetup/massModel.html#MassRateModelSettings" title="MassRateModelSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">MassRateModelSettings</span></code></a>, analogously how acceleration settings are defined by <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#AccelerationSettings" title="AccelerationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">AccelerationSettings</span></code></a> objects. The following code is used to create the mass rate models:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create mass rate models</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">MassRateModelSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">massRateModelSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">FromThrustMassModelSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">MassRateModel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">massRateModels</span><span class="p">;</span><span class="w"></span>
<span class="n">massRateModels</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Vehicle&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createMassRateModel</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="s">&quot;Vehicle&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">massRateModelSettings</span><span class="p">,</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>For our example, we want to derive the mass rate models from the thrust acceleration on <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code>. To this end, our mass rate model settings are of type <a class="reference internal" href="../tudatFeatures/accelerationSetup/massModel.html#FromThrustMassModelSettings" title="FromThrustMassModelSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">FromThrustMassModelSettings</span></code></a>. Please go to <a class="reference internal" href="../tudatFeatures/accelerationSetup/massModel.html#tudatfeaturesframeworkmassratemodelsetup"><span class="std std-ref">Mass Rate Model Set-up</span></a> for the available mass rate model settings. You may wonder why we are passing the value true to the constructor of this class. This is done to specify that the mass rate model should include expelled propellant due to all thrust forces acting on the body (for this example this makes no difference, but may be relevant for more detailed simulations).</p>
<p>The next step is to create the full settings for the propagation of the mass. Just like for the propagation of the dynamics, we create an object of a type (derived-from) <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettings.html#PropagatorSettings" title="PropagatorSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropagatorSettings</span></code></a>. For mass rate, this type is <code class="xref py py-class docutils literal notranslate"><span class="pre">MassPropagatorSettings</span></code>. It requires as input:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>List of bodies for which the mass is to be propagated.</p></li>
<li><p>Mass rate models for these bodies.</p></li>
<li><p>The initial masses of the bodies (stored in a Eigen::VectorXd).</p></li>
<li><p>Settings for when to terminate the propagation.</p></li>
</ol>
</div></blockquote>
<p>Below, you can see how these settings are passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">MassPropagatorSettings</span></code> constructor.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create settings for propagating the mass of the vehicle.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodiesWithMassToPropagate</span><span class="p">;</span><span class="w"></span>
<span class="n">bodiesWithMassToPropagate</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Vehicle&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">initialBodyMasses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">initialBodyMasses</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vehicleMass</span><span class="p">;</span><span class="w"></span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleArcPropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">massPropagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">MassPropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">bodiesWithMassToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">massRateModels</span><span class="p">,</span><span class="w"> </span><span class="n">initialBodyMasses</span><span class="p">,</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Our final step is to tell the software to propagate both the translational dynamics and body mass, which is achieved as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create list of propagation settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleArcPropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">propagatorSettingsVector</span><span class="p">;</span><span class="w"></span>
<span class="n">propagatorSettingsVector</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">translationalPropagatorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">propagatorSettingsVector</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">massPropagatorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create propagation settings for mass and translational dynamics concurrently</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">propagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">MultiTypePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">propagatorSettingsVector</span><span class="p">,</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>As is discussed in more detail in <a class="reference internal" href="../tudatFeatures/propagationSetup/simulatorCreation.html#tudatfeaturessimulatorcreation"><span class="std std-ref">Performing State Propagation</span></a>, the <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettings.html#PropagatorSettings" title="PropagatorSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropagatorSettings</span></code></a> object, which contains settings for both translational dynamics and mass rate, can be passed to the <a class="reference internal" href="../tudatFeatures/propagationSetup/simulatorCreation.html#SingleArcDynamicsSimulator" title="SingleArcDynamicsSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingleArcDynamicsSimulator</span></code></a> in the exact same manner as was done in the previous examples.</p>
</div>
<div class="section" id="results">
<h2><span class="section-number">5.3. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">Â¶</a></h2>
<p>Below, you see the resulting (in-plane) dynamics of the spacecraft and the mass of the vehicle as a function of time. The thrust force is along the velocity vector, constantly adding kinetic energy to the spacecraft. As a result, you can see the orbit slowly spiral outwards. Since the specific impulse and thrust force were both set to a constant value, the body mass decreases exactly linearly.</p>
<div class="figure align-default">
<img alt="../../_images/thrustAlongVelocityExampleResult.png" src="../../_images/thrustAlongVelocityExampleResult.png" />
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Open the figure in a new tab for more detail.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="useOfThrustUserDefinedThrustVector.html" class="btn btn-neutral float-right" title="6. Use of Thrust: User-defined Thrust Vector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="innerSolarSystemPropagation.html" class="btn btn-neutral" title="4. Inner Solar System Propagation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>â ï¸ This website is now mostly outdated! â ï¸</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>