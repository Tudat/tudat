

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Un-guided Capsule Entry &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../index.html"/>
        <link rel="up" title="Application Tutorials" href="index.html"/>
        <link rel="next" title="4. Inner Solar System Propagation" href="innerSolarSystemPropagation.html"/>
        <link rel="prev" title="2. Perturbed Earth-orbiting Satellite" href="perturbedEarthOrbitingSatellite.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Application Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#preparation">Preparation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#tudat-example-application-tutorials">Tudat Example Application Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="unperturbedEarthOrbitingSatellite.html">1. Unperturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="perturbedEarthOrbitingSatellite.html">2. Perturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">3. Un-guided Capsule Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="innerSolarSystemPropagation.html">4. Inner Solar System Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustThrustForceAlongVelocityVector.html">5. Use of Thrust: Thrust Force Along Velocity Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustUserDefinedThrustVector.html">6. Use of Thrust: User-defined Thrust Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="tabulatedAtmosphereExamples.html">7. Tabulated Atmosphere Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="propagatorTypesComparison.html">8. Comparison of Propagator Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="filterExample.html">9. Kalman Filter for State Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="variationalEquationsPropagation.html">10. Variational Equations Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterBasicStateEstimation.html">11. Orbit Determination and Parameter Estimation (Basic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterStateEstimation.html">12. Orbit Determination and Parameter Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="interplanetaryTrajectory.html">13. MGA Trajectory Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationCR3BP.html">14. Full propagation of the CR3BP</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationPatchedConicsTrajectory.html">15. Full propagation of a patched conics trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="shapeBasedTrajectory.html">16. Shape-Based Low-Thrust Trajectories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pagmo-optimization-tutorials">Pagmo Optimization Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tudatFeatures/index.html">Tudat Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Application Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">3. </span>Un-guided Capsule Entry</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/applicationWalkthroughs/unguidedCapsuleEntry.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="un-guided-capsule-entry">
<span id="walkthroughsunguidedcapsuleentry"></span><h1><span class="section-number">3. </span>Un-guided Capsule Entry<a class="headerlink" href="#un-guided-capsule-entry" title="Permalink to this headline">¶</a></h1>
<p>The example described on this page is that of Apollo on a re-entry trajectory towards the surface of Earth. The code for this tutorial is given on Github, and is also located in your Tudat bundle at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tudatBundle</span><span class="o">/</span><span class="n">tudatExampleApplications</span><span class="o">/</span><span class="n">satellitePropagatorExamples</span><span class="o">/</span><span class="n">SatellitePropagatorExamples</span><span class="o">/</span><span class="n">apolloCapsuleEntry</span><span class="o">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p>For this example, we have the following problem statement:</p>
<blockquote>
<div><p><em>Given the position and velocity of the Apollo capsule at a certain point in time with respect to the Earth, what will its position and velocity be once it reaches an altitude of 25 km over the surface of Earth?</em></p>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The example described in this page assumes that the user has read the <a class="reference internal" href="unperturbedEarthOrbitingSatellite.html#walkthroughsunperturbedearthorbitingsatellite"><span class="std std-ref">Unperturbed Earth-orbiting Satellite</span></a>. This page only describes the differences with respect to such example, so please go back before proceeding.</p>
</div>
<div class="section" id="create-the-vehicle">
<h2><span class="section-number">3.1. </span>Create the Vehicle<a class="headerlink" href="#create-the-vehicle" title="Permalink to this headline">¶</a></h2>
<p>First, the vehicle is created by placing an <code class="docutils literal notranslate"><span class="pre">&quot;Apollo&quot;</span></code> entry vehicle in the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code>, as shown below:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create vehicle objects.</span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">simulation_setup</span><span class="o">::</span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Once that is done, an <a class="reference internal" href="../tudatFeatures/environmentSetup/availableSettings.html#AerodynamicCoefficientInterface" title="AerodynamicCoefficientInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">AerodynamicCoefficientInterface</span></code></a> is linked to the vehicle by means of the following command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create vehicle aerodynamic coefficients</span>
<span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">setAerodynamicCoefficientInterface</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">unit_tests</span><span class="o">::</span><span class="n">getApolloCoefficientInterface</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>In this example a pre-made interface is used to define the aerodynamic coefficients. The <code class="docutils literal notranslate"><span class="pre">getApolloCoefficientInterface(</span> <span class="pre">)</span></code> function returns a <a class="reference internal" href="../tudatFeatures/environmentSetup/aerodynamicCoefficients.html#HypersonicLocalInclinationAnalysis" title="HypersonicLocalInclinationAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HypersonicLocalInclinationAnalysis</span></code></a> object, which is a derived-class from <a class="reference internal" href="../tudatFeatures/environmentSetup/availableSettings.html#AerodynamicCoefficientInterface" title="AerodynamicCoefficientInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">AerodynamicCoefficientInterface</span></code></a>. It computes the aerodynamic coefficients during propagation by means of a local-inclination method. Finally, the mass of the Apollo capsule is set and the body creation is finalized:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">setConstantBodyMass</span><span class="p">(</span><span class="w"> </span><span class="mf">5.0E3</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Finalize body creation.</span>
<span class="n">setGlobalFrameBodyEphemerides</span><span class="p">(</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SSB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;J2000&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to include a different vehicle, you will have to define a new <a class="reference internal" href="../tudatFeatures/environmentSetup/availableSettings.html#AerodynamicCoefficientInterface" title="AerodynamicCoefficientInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">AerodynamicCoefficientInterface</span></code></a> and implement your own custom aerodynamic database. Please go to <a class="reference internal" href="../tudatFeatures/accelerationSetup/aerodynamicGuidance.html#tudatfeaturesaerodynamicguidance"><span class="std std-ref">Aerodynamic Guidance</span></a> for further details.</p>
</div>
</div>
<div class="section" id="set-up-the-acceleration-models">
<h2><span class="section-number">3.2. </span>Set Up the Acceleration Models<a class="headerlink" href="#set-up-the-acceleration-models" title="Permalink to this headline">¶</a></h2>
<p>A major difference with respect to the <a class="reference internal" href="unperturbedEarthOrbitingSatellite.html#walkthroughsunperturbedearthorbitingsatellite"><span class="std std-ref">Unperturbed Earth-orbiting Satellite</span></a> is the use of a spherical-harmonic gravity model and the presence of an aerodynamic force on the vehicle. The spherical-harmonic gravity model is selected by the derived-class <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#SphericalHarmonicAccelerationSettings" title="SphericalHarmonicAccelerationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SphericalHarmonicAccelerationSettings</span></code></a> with degree and order as input parameters. Both acceleration models are added to the <code class="docutils literal notranslate"><span class="pre">accelerationMap</span></code> as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define acceleration model settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">accelerationsOfApollo</span><span class="p">;</span><span class="w"></span>
<span class="n">accelerationsOfApollo</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SphericalHarmonicAccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationsOfApollo</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">aerodynamic</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accelerationsOfApollo</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>A crucial step in re-entry modelling is the definition of an <a class="reference internal" href="../tudatFeatures/accelerationSetup/aerodynamicGuidance.html#AerodynamicGuidance" title="AerodynamicGuidance"><code class="xref py py-class docutils literal notranslate"><span class="pre">AerodynamicGuidance</span></code></a> model. Controlling the orientation of the vehicle during atmospheric flight plays an important role in the shape of the trajectory as well as on the magnitude of the aerodynamic and thermal loads. In this example, a simple fixed-angle aerodynamic guidance model is used. This is implemented using a lambda expression (explained in detail <a class="reference internal" href="../basics/externalLibraries/utilityExamples.html#exampleutilitylambdaexpression"><span class="std std-ref">here</span></a>). In short this function always outputs the value of <code class="docutils literal notranslate"><span class="pre">constantAngleOfAttack</span></code>, which in turn sets the orientation angles of the <code class="docutils literal notranslate"><span class="pre">&quot;Apollo&quot;</span></code> body:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define constant 30 degree angle of attack</span>
<span class="kt">double</span><span class="w"> </span><span class="n">constantAngleOfAttack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit_conversions</span><span class="o">::</span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="mf">30.0</span><span class="p">);</span><span class="w"></span>
<span class="n">bodyMap</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getFlightConditions</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getAerodynamicAngleCalculator</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">setOrientationAngleFunctions</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">](</span><span class="w"> </span><span class="p">){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">constantAngleOfAttack</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To view the available options for aerodynamic guidance check out the <a class="reference internal" href="../tudatFeatures/accelerationSetup/aerodynamicGuidance.html#tudatfeaturesaerodynamicguidance"><span class="std std-ref">Aerodynamic Guidance</span></a> section.</p>
</div>
</div>
<div class="section" id="set-up-the-propagation-settings">
<h2><span class="section-number">3.3. </span>Set Up the Propagation Settings<a class="headerlink" href="#set-up-the-propagation-settings" title="Permalink to this headline">¶</a></h2>
<p>In most re-entry studies, it is convenient to define the entry conditions using a spherical state. The following entry state is used:</p>
<blockquote>
<div><ul class="simple">
<li><p>Altitude: 120 km</p></li>
<li><p>Latitude: 0 deg</p></li>
<li><p>Longitude: 68.75 deg</p></li>
<li><p>Inertial speed: 7.7 km/s</p></li>
<li><p>Flight-path angle: -0.9 deg</p></li>
<li><p>Heading angle: 34.37 deg</p></li>
</ul>
</div></blockquote>
<p>Such state must be defined and converted to Cartesian state variables as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set spherical elements for Apollo.</span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="n">apolloSphericalEntryState</span><span class="p">;</span><span class="w"></span>
<span class="n">apolloSphericalEntryState</span><span class="p">(</span><span class="w"> </span><span class="n">SphericalOrbitalStateElementIndices</span><span class="o">::</span><span class="n">radiusIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">spice_interface</span><span class="o">::</span><span class="n">getAverageRadius</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">120.0E3</span><span class="p">;</span><span class="w"></span>
<span class="n">apolloSphericalEntryState</span><span class="p">(</span><span class="w"> </span><span class="n">SphericalOrbitalStateElementIndices</span><span class="o">::</span><span class="n">latitudeIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">unit_conversions</span><span class="o">::</span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">apolloSphericalEntryState</span><span class="p">(</span><span class="w"> </span><span class="n">SphericalOrbitalStateElementIndices</span><span class="o">::</span><span class="n">longitudeIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">unit_conversions</span><span class="o">::</span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">68.75</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">apolloSphericalEntryState</span><span class="p">(</span><span class="w"> </span><span class="n">SphericalOrbitalStateElementIndices</span><span class="o">::</span><span class="n">speedIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.7E3</span><span class="p">;</span><span class="w"></span>
<span class="n">apolloSphericalEntryState</span><span class="p">(</span><span class="w"> </span><span class="n">SphericalOrbitalStateElementIndices</span><span class="o">::</span><span class="n">flightPathIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">unit_conversions</span><span class="o">::</span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">-0.9</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">apolloSphericalEntryState</span><span class="p">(</span><span class="w"> </span><span class="n">SphericalOrbitalStateElementIndices</span><span class="o">::</span><span class="n">headingAngleIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">unit_conversions</span><span class="o">::</span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">34.37</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Convert apollo state from spherical elements to Cartesian elements.</span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="n">systemInitialState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertSphericalOrbitalToCartesianState</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">apolloSphericalEntryState</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Finally, the state needs to be converted to inertial frame. As it is customary, in fact, the spherical state above (and thus also the converted Cartesian state), is defined in the rotating frame centered at the Earth center (ECEF). However, as mentioned in <a class="reference internal" href="unperturbedEarthOrbitingSatellite.html#walkthroughsunperturbedearthorbitingsatellite"><span class="std std-ref">Unperturbed Earth-orbiting Satellite</span></a>, in Tudat propagation can only occurr in inertial frames. Hence, the following lines are included:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Convert the state to the global (inertial) frame.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ephemerides</span><span class="o">::</span><span class="n">RotationalEphemeris</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">earthRotationalEphemeris</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">bodyMap</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getRotationalEphemeris</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">systemInitialState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformStateToGlobalFrame</span><span class="p">(</span><span class="w"> </span><span class="n">systemInitialState</span><span class="p">,</span><span class="w"> </span><span class="n">simulationStartEpoch</span><span class="p">,</span><span class="w"> </span><span class="n">earthRotationalEphemeris</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">latitudeIndex</span></code> of <code class="docutils literal notranslate"><span class="pre">apolloSphericalEntryState</span></code> makes reference to the <strong>geocentric</strong> latitude.</p>
</div>
<div class="section" id="create-a-list-of-dependent-variables-to-save">
<h3><span class="section-number">3.3.1. </span>Create a List of Dependent Variables to Save<a class="headerlink" href="#create-a-list-of-dependent-variables-to-save" title="Permalink to this headline">¶</a></h3>
<p>In this example, a number of dependent variables are saved to plot the trajectory of Apollo after re-entry. The following dependent variables are saved:</p>
<blockquote>
<div><ul class="simple">
<li><p>Mach number</p></li>
<li><p>Altitude</p></li>
<li><p>Aerodynamic acceleration norm</p></li>
<li><p>Aerodynamic force coefficients (<span class="math notranslate nohighlight">\(C_D\)</span>, <span class="math notranslate nohighlight">\(C_S\)</span>, <span class="math notranslate nohighlight">\(C_L\)</span>)</p></li>
</ul>
</div></blockquote>
<p>First, a <code class="docutils literal notranslate"><span class="pre">dependentVariablesList</span></code> needs to be created, which will list all the variables to save:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define list of dependent variables to save.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">dependentVariablesList</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Next, the list is populated with the desired dependent variables. Please go to <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettingsDependentVariables.html#tudatfeaturespropagatorsettingsdependentvariables"><span class="std std-ref">Propagator Settings: Dependent Variables</span></a> for further details on the various dependent variables that can be stored:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">dependentVariablesList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                      </span><span class="n">mach_number_dependent_variable</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">dependentVariablesList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                      </span><span class="n">altitude_dependent_variable</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">dependentVariablesList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleAccelerationDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                      </span><span class="n">aerodynamic</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">dependentVariablesList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                      </span><span class="n">aerodynamic_force_coefficients_dependent_variable</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create object with list of dependent variables</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">DependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">dependentVariablesToSave</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">DependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">dependentVariablesList</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you do not want the console output generated by <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettingsDependentVariables.html#DependentVariableSaveSettings" title="DependentVariableSaveSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">DependentVariableSaveSettings</span></code></a> to show, you can simply set the second input argument as <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
</div>
<div class="section" id="define-the-termination-conditions">
<h3><span class="section-number">3.3.2. </span>Define the Termination Conditions<a class="headerlink" href="#define-the-termination-conditions" title="Permalink to this headline">¶</a></h3>
<p>Finally, the termination conditions are established. The termination settings are stored in the <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettingsTermination.html#PropagationTerminationSettings" title="PropagationTerminationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropagationTerminationSettings</span></code></a> object. In this example, the re-entry trajectory is propagated until Apollo’s altitude drops below 25 km. The boolean in the constructor of the derived-class <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettingsTermination.html#PropagationDependentVariableTerminationSettings" title="PropagationDependentVariableTerminationSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropagationDependentVariableTerminationSettings</span></code></a> indicates whether the simulation is terminated when <code class="docutils literal notranslate"><span class="pre">terminationDependentVariable</span></code> goes below the supplied value (<code class="docutils literal notranslate"><span class="pre">true</span></code>) or above (<code class="docutils literal notranslate"><span class="pre">false</span></code>):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define termination conditions</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">terminationDependentVariable</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">SingleDependentVariableSaveSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">altitude_dependent_variable</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Apollo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PropagationTerminationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">terminationSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PropagationDependentVariableTerminationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">terminationDependentVariable</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0E3</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Please go to <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettingsTermination.html#tudatfeaturespropagatorsettingstermination"><span class="std std-ref">Propagator Settings: Termination Settings</span></a> for a detailed description of the available termination conditions.</p>
</div>
</div>
</div>
<div class="section" id="results">
<h2><span class="section-number">3.4. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>Below the history of some of the saved parameters is shown. One can see the capsule skipping several times before its final descent into the atmosphere, where it reaches 25 km altitude. The dependent variable history can be obtained in Tudat from the <code class="docutils literal notranslate"><span class="pre">getDependentVariableHistory</span></code> function of the <a class="reference internal" href="../tudatFeatures/propagationSetup/simulatorCreation.html#DynamicsSimulator" title="DynamicsSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicsSimulator</span></code></a> class. The resulting <code class="docutils literal notranslate"><span class="pre">std::map</span></code> can be saved as discussed in <a class="reference internal" href="../tudatFeatures/otherLibraries/inputOutput.html#tudatfeaturesinputoutput"><span class="std std-ref">Input/Output</span></a>.</p>
<div class="figure align-default">
<img alt="../../_images/apolloResults.png" src="../../_images/apolloResults.png" />
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Open the figure in a new tab for more detail.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="innerSolarSystemPropagation.html" class="btn btn-neutral float-right" title="4. Inner Solar System Propagation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="perturbedEarthOrbitingSatellite.html" class="btn btn-neutral" title="2. Perturbed Earth-orbiting Satellite" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>⚠️ This website is now mostly outdated! ⚠️</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>