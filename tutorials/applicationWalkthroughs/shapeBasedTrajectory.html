

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>16. Shape-Based Low-Thrust Trajectories &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../index.html"/>
        <link rel="up" title="Application Tutorials" href="index.html"/>
        <link rel="next" title="1. Himmelblau Optimization" href="himmelblau.html"/>
        <link rel="prev" title="15. Full propagation of a patched conics trajectory" href="fullPropagationPatchedConicsTrajectory.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Application Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#preparation">Preparation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#tudat-example-application-tutorials">Tudat Example Application Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="unperturbedEarthOrbitingSatellite.html">1. Unperturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="perturbedEarthOrbitingSatellite.html">2. Perturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="unguidedCapsuleEntry.html">3. Un-guided Capsule Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="innerSolarSystemPropagation.html">4. Inner Solar System Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustThrustForceAlongVelocityVector.html">5. Use of Thrust: Thrust Force Along Velocity Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustUserDefinedThrustVector.html">6. Use of Thrust: User-defined Thrust Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="tabulatedAtmosphereExamples.html">7. Tabulated Atmosphere Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="propagatorTypesComparison.html">8. Comparison of Propagator Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="filterExample.html">9. Kalman Filter for State Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="variationalEquationsPropagation.html">10. Variational Equations Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterBasicStateEstimation.html">11. Orbit Determination and Parameter Estimation (Basic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterStateEstimation.html">12. Orbit Determination and Parameter Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="interplanetaryTrajectory.html">13. MGA Trajectory Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationCR3BP.html">14. Full propagation of the CR3BP</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationPatchedConicsTrajectory.html">15. Full propagation of a patched conics trajectory</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">16. Shape-Based Low-Thrust Trajectories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pagmo-optimization-tutorials">Pagmo Optimization Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tudatFeatures/index.html">Tudat Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Application Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">16. </span>Shape-Based Low-Thrust Trajectories</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/applicationWalkthroughs/shapeBasedTrajectory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="shape-based-low-thrust-trajectories">
<span id="walkthroughsshapebasedtrajectory"></span><h1><span class="section-number">16. </span>Shape-Based Low-Thrust Trajectories<a class="headerlink" href="#shape-based-low-thrust-trajectories" title="Permalink to this headline">¶</a></h1>
<p>The example described in this tutorial presents the use of shape-based methods to design low-thrust trajectories. The code for this tutorial is given on Github, and is also located in your Tudat bundle at:</p>
<blockquote>
<div><p>tudatBundle/tudatExampleApplications/libraryExamples/satellitePropagatorExamples/shapeBasedTrajectoryDesign.cpp</p>
</div></blockquote>
<p>This tutorial presents how a preliminary low-thrust trajectory can be obtained using various shape-based methods. The optimisation of the trajectory will not be addressed here, but this tutorial rather focuses on how to design a feasible trajectory for an Earth-Mars transfer which respects boundary conditions at departure and arrival, as well as the specified value of the time-of-flight.</p>
<p>Shaping methods use a simplified, unperturbed model to compute shaped trajectories. This tutorial also presents the numerical propagation of the fully perturbed problem, and compares the results with the analytical trajectory derived from the shape-based methods.</p>
<div class="section" id="set-up-the-problem">
<h2><span class="section-number">16.1. </span>Set up the problem<a class="headerlink" href="#set-up-the-problem" title="Permalink to this headline">¶</a></h2>
<p>The boundary conditions of the problem, required Cartesian state and time at departure and arrival (or in this case the time-of-flight), are first defined  for the targeted trajectory. In addition, the expected number of revolutions are specified. This describes the trajectory design problem that is to be tackled with shape-based methods.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">numberOfRevolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">julianDateAtDeparture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8174.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">physical_constants</span><span class="o">::</span><span class="n">JULIAN_DAY</span><span class="p">;</span><span class="w"></span>
<span class="kt">double</span><span class="w">  </span><span class="n">timeOfFlight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">580.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">physical_constants</span><span class="o">::</span><span class="n">JULIAN_DAY</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Ephemeris departure body.</span>
<span class="n">ephemerides</span><span class="o">::</span><span class="n">EphemerisPointer</span><span class="w"> </span><span class="n">pointerToDepartureBodyEphemeris</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ephemerides</span><span class="o">::</span><span class="n">ApproximatePlanetPositions</span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">ephemerides</span><span class="o">::</span><span class="n">ApproximatePlanetPositionsBase</span><span class="o">::</span><span class="n">BodiesWithEphemerisData</span><span class="o">::</span><span class="n">earthMoonBarycenter</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Ephemeris arrival body.</span>
<span class="n">ephemerides</span><span class="o">::</span><span class="n">EphemerisPointer</span><span class="w"> </span><span class="n">pointerToArrivalBodyEphemeris</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ephemerides</span><span class="o">::</span><span class="n">ApproximatePlanetPositions</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">ephemerides</span><span class="o">::</span><span class="n">ApproximatePlanetPositionsBase</span><span class="o">::</span><span class="n">BodiesWithEphemerisData</span><span class="o">::</span><span class="n">mars</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Retrieve cartesian state at departure and arrival.</span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="n">cartesianStateAtDeparture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointerToDepartureBodyEphemeris</span><span class="o">-&gt;</span><span class="n">getCartesianState</span><span class="p">(</span><span class="w"> </span><span class="n">julianDateAtDeparture</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="n">cartesianStateAtArrival</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointerToArrivalBodyEphemeris</span><span class="o">-&gt;</span><span class="n">getCartesianState</span><span class="p">(</span><span class="w"> </span><span class="n">julianDateAtDeparture</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeOfFlight</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The environment within which the trajectory of the spacecraft is to be calculated is set up in a similar manner as in the previous tutorials: the required celestial bodies are created (from default body settings), along with a body object representing our vehicle. The ephemeris of the Sun (central body of the trajectory) is defined so that it stays at the Solar System Barycenter.</p>
</div>
<div class="section" id="set-up-the-accelerations-unperturbed-and-perturbed-cases">
<h2><span class="section-number">16.2. </span>Set up the accelerations (unperturbed and perturbed cases)<a class="headerlink" href="#set-up-the-accelerations-unperturbed-and-perturbed-cases" title="Permalink to this headline">¶</a></h2>
<p>Two different sets of accelerations are defined here:</p>
<blockquote>
<div><ul class="simple">
<li><p>The first one corresponds to the unperturbed problem: only the two accelerations already accounted for in the shape-based trajectory design (namely central body gravitational acceleration and low-thrust acceleration) are exerted on the spacecraft.</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define acceleration map for the simplified problem.</span>
<span class="c1">// (empty map as central gravity and low-thrust accelerations are already included in the shape-based methods)</span>
<span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">AccelerationMap</span><span class="w"> </span><span class="n">perturbingAccelerationsMapSimplifiedProblem</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<ul>
<li><p>In the second case, additional perturbations are taken into account:</p>
<blockquote>
<div><ul class="simple">
<li><p>Gravitational attraction exerted by the Earth, Mars, and Jupiter.</p></li>
<li><p>Solar radiation pressure</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define acceleration map for the fully perturbed problem.</span>

<span class="c1">// Define propagation settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">accelerationSettingsPerturbedProblem</span><span class="p">;</span><span class="w"></span>
<span class="n">accelerationSettingsPerturbedProblem</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">central_gravity</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationSettingsPerturbedProblem</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Mars&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">central_gravity</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationSettingsPerturbedProblem</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Jupiter&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">central_gravity</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationSettingsPerturbedProblem</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Sun&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">cannon_ball_radiation_pressure</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
<p>The definition of additional perturbations will later aim at quantifying the effects of the simplifying assumptions used in the shape-based trajectory design, when propagating the fully perturbed trajectory of the spacecraft.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The set of accelerations defined above are later used to define appropriate <code class="docutils literal notranslate"><span class="pre">propagatorSettings</span></code> object for the numerical propagation. The function <code class="docutils literal notranslate"><span class="pre">computeSemiAnalyticalAndFullPropagation</span></code> which performs the propagation of the fully perturbed problem takes a <code class="docutils literal notranslate"><span class="pre">propagatorSettings</span></code> object as input, but the set of accelerations used to define them must contain <strong>perturbing</strong> accelerations only. So gravitational acceleration exerted by the central body and thrust acceleration should not be considered here, as they are already taken into account by the shaping method.</p>
</div>
</div>
<div class="section" id="set-up-hodographic-shaping">
<h2><span class="section-number">16.3. </span>Set up hodographic shaping<a class="headerlink" href="#set-up-hodographic-shaping" title="Permalink to this headline">¶</a></h2>
<p>Using hodographic shaping to design a low-thrust trajectory requires the definition of three different shaping functions, one for each of the cylindrical velocity components. The shaping functions are defined as a combination of so-called base functions. As described in the hodographic shaping documentation (<a class="reference internal" href="../tudatFeatures/lowThrustTrajectoryDesign/shapeBasedMethods/hodographicShaping.html#tudatfeatureshodographicshaping"><span class="std std-ref">Hodographic shaping</span></a>), at least three base functions must be defined for each velocity component to ensure the boundary conditions are fulfilled.</p>
<p>The frequency of any trigonometric-like base functions and the scale factor used are defined as follows (recommended values depend on the time-of-flight):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="n">frequency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mathematical_constants</span><span class="o">::</span><span class="n">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">timeOfFlight</span><span class="p">;</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">timeOfFlight</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The settings for each of the radial velocity component base functions are then defined:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create base function settings for the components of the radial velocity composite function.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">firstRadialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">secondRadialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PowerFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thirdRadialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PowerFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">createBaseFunctionHodographicShaping</span></code> can be called to create the corresponding base functions from the above-defined settings. The base functions defined that way are pushed to a <code class="docutils literal notranslate"><span class="pre">std::vector&lt;</span> <span class="pre">std::shared_ptr&lt;</span> <span class="pre">BaseFunctionHodographicShaping</span> <span class="pre">&gt;</span> <span class="pre">&gt;</span></code> object, which is latter used as an input parameter to create the <code class="docutils literal notranslate"><span class="pre">HodographicShaping</span></code> object.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create components of the radial velocity composite function.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShaping</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">radialVelocityFunctionComponents</span><span class="p">;</span><span class="w"></span>
<span class="n">radialVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">constant</span><span class="p">,</span><span class="w"> </span><span class="n">firstRadialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">radialVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">scaledPower</span><span class="p">,</span><span class="w"> </span><span class="n">secondRadialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">radialVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">scaledPower</span><span class="p">,</span><span class="w"> </span><span class="n">thirdRadialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>A similar process is repeated for the normal and axial components of the spacecraft cylindrical velocity.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create base function settings for the components of the normal velocity composite function.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">firstNormalVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">secondNormalVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PowerFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thirdNormalVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PowerFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create components of the normal velocity composite function.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">shape_based_methods</span><span class="o">::</span><span class="n">BaseFunctionHodographicShaping</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">normalVelocityFunctionComponents</span><span class="p">;</span><span class="w"></span>
<span class="n">normalVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">constant</span><span class="p">,</span><span class="w"> </span><span class="n">firstNormalVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">normalVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">scaledPower</span><span class="p">,</span><span class="w"> </span><span class="n">secondNormalVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">normalVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">scaledPower</span><span class="p">,</span><span class="w"> </span><span class="n">thirdNormalVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create base function settings for the components of the axial velocity composite function.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">firstAxialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TrigonometricFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">numberOfRevolutions</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">frequency</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">secondAxialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PowerTimesTrigonometricFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">numberOfRevolutions</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BaseFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thirdAxialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">PowerTimesTrigonometricFunctionHodographicShapingSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">numberOfRevolutions</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">frequency</span><span class="p">,</span><span class="w"> </span><span class="n">scaleFactor</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create components for the axial velocity composite function.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">shape_based_methods</span><span class="o">::</span><span class="n">BaseFunctionHodographicShaping</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">axialVelocityFunctionComponents</span><span class="p">;</span><span class="w"></span>
<span class="n">axialVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">cosine</span><span class="p">,</span><span class="w"> </span><span class="n">firstAxialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">axialVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">scaledPowerCosine</span><span class="p">,</span><span class="w"> </span><span class="n">secondAxialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">axialVelocityFunctionComponents</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">createBaseFunctionHodographicShaping</span><span class="p">(</span><span class="w"> </span><span class="n">scaledPowerSine</span><span class="p">,</span><span class="w"> </span><span class="n">thirdAxialVelocityBaseFunctionSettings</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>In hodographic shaping, the values of the free coefficients, if any, should be provided as inputs of the <code class="docutils literal notranslate"><span class="pre">HodographicShaping</span></code> object constructor. Here, only three base functions are provided per velocity component, which corresponds to the minimum required to satisfy the boundary conditions. So the free coefficients vectors are here just empty vectors.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Initialize free coefficients vector for radial velocity function (empty here, only 3 base functions).</span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">freeCoefficientsRadialVelocityFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Initialize free coefficients vector for normal velocity function (empty here, only 3 base functions).</span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">freeCoefficientsNormalVelocityFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Initialize free coefficients vector for axial velocity function (empty here, only 3 base functions).</span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">freeCoefficientsAxialVelocityFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">HodographicShaping</span></code> object can be created:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create hodographic-shaping object with defined velocity functions and boundary conditions.</span>
<span class="n">shape_based_methods</span><span class="o">::</span><span class="n">HodographicShaping</span><span class="w"> </span><span class="nf">hodographicShaping</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cartesianStateAtDeparture</span><span class="p">,</span><span class="w"> </span><span class="n">cartesianStateAtArrival</span><span class="p">,</span><span class="w"> </span><span class="n">timeOfFlight</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Borzi&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sun&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">radialVelocityFunctionComponents</span><span class="p">,</span><span class="w"> </span><span class="n">normalVelocityFunctionComponents</span><span class="p">,</span><span class="w"> </span><span class="n">axialVelocityFunctionComponents</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">freeCoefficientsRadialVelocityFunction</span><span class="p">,</span><span class="w"> </span><span class="n">freeCoefficientsNormalVelocityFunction</span><span class="p">,</span><span class="w"> </span><span class="n">freeCoefficientsAxialVelocityFunction</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">integratorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="set-up-spherical-shaping">
<h2><span class="section-number">16.4. </span>Set up spherical shaping<a class="headerlink" href="#set-up-spherical-shaping" title="Permalink to this headline">¶</a></h2>
<p>The definition of a spherically shaped trajectory is much more straightforward than that of a hodographically shaped one. This is mostly due to the fact that the base functions used to map the spherical position of the spacecraft in spherical shaping are fixed, while those used in hodographic shaping have to be selected by the user. Also, there is no free parameters in spherical shaping, so the shaping function is pre-defined and cannot be tuned by the user.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define root finder settings (used to update the value of the free coefficient, so that it matches the required time of flight).</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">root_finders</span><span class="o">::</span><span class="n">RootFinderSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">rootFinderSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">root_finders</span><span class="o">::</span><span class="n">RootFinderSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">root_finders</span><span class="o">::</span><span class="n">bisection_root_finder</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Compute shaped trajectory.</span>
<span class="n">shape_based_methods</span><span class="o">::</span><span class="n">SphericalShaping</span><span class="w"> </span><span class="n">sphericalShaping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape_based_methods</span><span class="o">::</span><span class="n">SphericalShaping</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">cartesianStateAtDeparture</span><span class="p">,</span><span class="w"> </span><span class="n">cartesianStateAtArrival</span><span class="p">,</span><span class="w"> </span><span class="n">timeOfFlight</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">numberOfRevolutions</span><span class="p">,</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Borzi&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sun&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000703</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">rootFinderSettings</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0e-1</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="retrieve-trajectory-mass-thrust-and-thrust-acceleration-profiles">
<h2><span class="section-number">16.5. </span>Retrieve trajectory, mass, thrust, and thrust acceleration profiles<a class="headerlink" href="#retrieve-trajectory-mass-thrust-and-thrust-acceleration-profiles" title="Permalink to this headline">¶</a></h2>
<p>From any <code class="docutils literal notranslate"><span class="pre">ShapeBasedMethodLeg</span></code> object, the trajectory of the spacecraft, along with the corresponding mass, thrust, and thrust acceleration profiles can be retrieved. This is done here for both the hodographically and spherically shaped trajectories. The code used for hodographic shaping is reproduced below (and it is done for spherical shaping in exactly the same way).</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Hodographic shaping</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">epochsVectorHodographicShaping</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">itr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hodographicShapingAnalyticalResults</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">itr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">hodographicShapingAnalyticalResults</span><span class="p">.</span><span class="n">end</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">itr</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">epochsVectorHodographicShaping</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">itr</span><span class="o">-&gt;</span><span class="n">first</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hodographicShapingMassProfile</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hodographicShapingThrustProfile</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hodographicShapingThrustAccelerationProfile</span><span class="p">;</span><span class="w"></span>

<span class="n">hodographicShaping</span><span class="p">.</span><span class="n">getMassProfile</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">epochsVectorHodographicShaping</span><span class="p">,</span><span class="w"> </span><span class="n">hodographicShapingMassProfile</span><span class="p">,</span><span class="w"> </span><span class="n">specificImpulseFunction</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">hodographicShaping</span><span class="p">.</span><span class="n">getThrustProfile</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">epochsVectorHodographicShaping</span><span class="p">,</span><span class="w"> </span><span class="n">hodographicShapingThrustProfile</span><span class="p">,</span><span class="w"> </span><span class="n">specificImpulseFunction</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">hodographicShaping</span><span class="p">.</span><span class="n">getThrustAccelerationProfile</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">epochsVectorHodographicShaping</span><span class="p">,</span><span class="w"> </span><span class="n">hodographicShapingThrustAccelerationProfile</span><span class="p">,</span><span class="w"> </span><span class="n">specificImpulseFunction</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The plot below presents the Earth-Mars trajectories obtained with both hodographic (red) and spherical (blue) shaping methods. The associated thrust acceleration, thrust, and mass profiles are plotted too.</p>
<div class="figure align-default">
<img alt="../../_images/shapeBasedProfiles.png" src="../../_images/shapeBasedProfiles.png" />
</div>
</div>
<div class="section" id="numerically-propagate-the-unperturbed-problem">
<h2><span class="section-number">16.6. </span>Numerically propagate the unperturbed problem<a class="headerlink" href="#numerically-propagate-the-unperturbed-problem" title="Permalink to this headline">¶</a></h2>
<p>The unperturbed problem (with central body gravitational acceleration and spacecraft low-thrust acceleration as defined by the shaping method) is propagated numerically. To this end, the method <code class="docutils literal notranslate"><span class="pre">computeSemiAnalyticalAndFullPropagation</span></code> of the <code class="docutils literal notranslate"><span class="pre">ShapeBasedMethodLeg</span></code> is called and provides the analytical, shape-based trajectory, and the result of the numerically propagated trajectory.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hodographicShapingFullPropagationResults</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hodographicShapingAnalyticalResults</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hodographicShapingDependentVariablesHistory</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Create propagator settings for hodographic shaping.</span>
<span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">propagators</span><span class="o">::</span><span class="n">PropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">propagators</span><span class="o">::</span><span class="n">PropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="n">hodographicShapingPropagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hodographicShaping</span><span class="p">.</span><span class="n">createLowThrustPropagatorSettings</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">specificImpulseFunction</span><span class="p">,</span><span class="w"> </span><span class="n">perturbingAccelerationsMapSimplifiedProblem</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">dependentVariablesToSave</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Compute shaped trajectory and propagated trajectory.</span>
<span class="n">hodographicShaping</span><span class="p">.</span><span class="n">computeSemiAnalyticalAndFullPropagation</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">integratorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">hodographicShapingPropagatorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">hodographicShapingFullPropagationResults</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">hodographicShapingAnalyticalResults</span><span class="p">,</span><span class="w"> </span><span class="n">hodographicShapingDependentVariablesHistory</span><span class="w"> </span><span class="p">);</span><span class="w"></span>


<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sphericalShapingFullPropagationResults</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sphericalShapingAnalyticalResults</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sphericalShapingDependentVariablesHistory</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Create propagator settings for spherical shaping.</span>
<span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">propagators</span><span class="o">::</span><span class="n">PropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">propagators</span><span class="o">::</span><span class="n">PropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="n">sphericalShapingPropagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sphericalShaping</span><span class="p">.</span><span class="n">createLowThrustPropagatorSettings</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">specificImpulseFunction</span><span class="p">,</span><span class="w"> </span><span class="n">perturbingAccelerationsMapSimplifiedProblem</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">dependentVariablesToSave</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Compute shaped trajectory and propagated trajectory.</span>
<span class="n">sphericalShaping</span><span class="p">.</span><span class="n">computeSemiAnalyticalAndFullPropagation</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">integratorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">sphericalShapingPropagatorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">sphericalShapingFullPropagationResults</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">sphericalShapingAnalyticalResults</span><span class="p">,</span><span class="w"> </span><span class="n">sphericalShapingDependentVariablesHistory</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="numerically-propagate-the-perturbed-problem">
<h2><span class="section-number">16.7. </span>Numerically propagate the perturbed problem<a class="headerlink" href="#numerically-propagate-the-perturbed-problem" title="Permalink to this headline">¶</a></h2>
<p>The same is done using a different, more complete set of perturbing accelerations. The only difference is that the set of <code class="docutils literal notranslate"><span class="pre">PropagatorSettings</span></code> is defined differently, using the more complete set of perturbing accelerations that have been defined previously (gravitational attractions from Earth, Mars and Jupiter, and solar radiation pressure). Otherwise, the code is strickly the same as the one used to propagate the unperturbed problem.</p>
</div>
<div class="section" id="results">
<h2><span class="section-number">16.8. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>The application output should look like:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>Starting C:\tudatBundle\tudatExampleApplications\satellitePropagatorExamples\bin\applications\application_ShapeBasedTrajectoryDesign.exe...
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
Dependent variables being saved, output vectors contain:
Vector entry, Vector contents
deltaV hodographic shaping: 21051.4

deltaV spherical shaping: 5698.9

C:/tudatBundle/tudatExampleApplications/satellitePropagatorExamples/bin/applications/application_ShapeBasedTrajectoryDesign.exe exited with code 0
</pre></div>
</div>
<p>The results of the numerical propagation (for both the unperturbed and perturbed cases) obtained with the two different shape-based methods are presented in the plot below. The difference in position between the analytical solution (so shaped trajectory, by definition computed under simplifying assumptions) and the full propagation numerical solution is plotted. The fully perturbed trajectory is propagated from half of the time-of-flight, backwards until departure, and forwards until arrival. This explains why the difference between analytical and numerical solutions is always zero in the middle of the trajectory, and grows larger when getting closer to either departure or arrival, as the effects of the perturbing accelerations keep propagating and adding up to each other.</p>
<div class="figure align-default">
<img alt="../../_images/analyticalVsPropagationShapingMethods.png" src="../../_images/analyticalVsPropagationShapingMethods.png" />
</div>
<p>In the unperturbed case, the analytical and numerical solutions are extremely similar. This is in agreement with the fact that no additional perturbing accelerations are considered in the numerical propagation of the problem, so that the observed differences are only due to integration errors. The fact that the difference between analytical and numerical results is (significantly) higher for spherical shaping can be explained by its independent variable which is not time, but azimuth angle. This requires an additional step to convert time to azimuth angle (and the other way around), compared to hodographic shaping. This conversion makes use of an interpolator, and the higher differences are due to interpolation errors (which unfortunately build up along the propagation).</p>
<p>The perturbed case shows larger differences between the shape-based and the propagated trajectories, because of the perturbing accelerations which are introduced in the numerical propagation.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="himmelblau.html" class="btn btn-neutral float-right" title="1. Himmelblau Optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fullPropagationPatchedConicsTrajectory.html" class="btn btn-neutral" title="15. Full propagation of a patched conics trajectory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>⚠️ This website is now mostly outdated! ⚠️</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>