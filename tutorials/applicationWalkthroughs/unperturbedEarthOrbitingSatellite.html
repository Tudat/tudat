

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Unperturbed Earth-orbiting Satellite &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../index.html"/>
        <link rel="up" title="Application Tutorials" href="index.html"/>
        <link rel="next" title="2. Perturbed Earth-orbiting Satellite" href="perturbedEarthOrbitingSatellite.html"/>
        <link rel="prev" title="Application Tutorials" href="index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Application Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#preparation">Preparation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#tudat-example-application-tutorials">Tudat Example Application Tutorials</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">1. Unperturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="perturbedEarthOrbitingSatellite.html">2. Perturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="unguidedCapsuleEntry.html">3. Un-guided Capsule Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="innerSolarSystemPropagation.html">4. Inner Solar System Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustThrustForceAlongVelocityVector.html">5. Use of Thrust: Thrust Force Along Velocity Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="useOfThrustUserDefinedThrustVector.html">6. Use of Thrust: User-defined Thrust Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="tabulatedAtmosphereExamples.html">7. Tabulated Atmosphere Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="propagatorTypesComparison.html">8. Comparison of Propagator Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="filterExample.html">9. Kalman Filter for State Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="variationalEquationsPropagation.html">10. Variational Equations Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterBasicStateEstimation.html">11. Orbit Determination and Parameter Estimation (Basic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthOrbiterStateEstimation.html">12. Orbit Determination and Parameter Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="interplanetaryTrajectory.html">13. MGA Trajectory Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationCR3BP.html">14. Full propagation of the CR3BP</a></li>
<li class="toctree-l4"><a class="reference internal" href="fullPropagationPatchedConicsTrajectory.html">15. Full propagation of a patched conics trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="shapeBasedTrajectory.html">16. Shape-Based Low-Thrust Trajectories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pagmo-optimization-tutorials">Pagmo Optimization Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tudatFeatures/index.html">Tudat Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matlabInterface/index.html">MATLAB Interface</a></li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Application Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">1. </span>Unperturbed Earth-orbiting Satellite</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/applicationWalkthroughs/unperturbedEarthOrbitingSatellite.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="unperturbed-earth-orbiting-satellite">
<span id="walkthroughsunperturbedearthorbitingsatellite"></span><h1><span class="section-number">1. </span>Unperturbed Earth-orbiting Satellite<a class="headerlink" href="#unperturbed-earth-orbiting-satellite" title="Permalink to this headline">¶</a></h1>
<p>The example described on this page is that of Asterix, a single satellite that is orbiting the Earth. The code for this tutorial is given on Github, and is also located in your Tudat bundle at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tudatBundle</span><span class="o">/</span><span class="n">tudatExampleApplications</span><span class="o">/</span><span class="n">satellitePropagatorExamples</span><span class="o">/</span><span class="n">SatellitePropagatorExamples</span><span class="o">/</span><span class="n">singleSatellitePropagator</span><span class="o">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p>For this example, we have the following problem statement:</p>
<blockquote>
<div><p><em>Given the position and velocity of the Asterix satellite at a certain point in time with respect to the Earth, what will its position and velocity be after a Julian day has passed?</em></p>
</div></blockquote>
<p>There are a number of assumptions we can make in answering this question, which is often the case when translating a problem statement into a simulation. In our first tutorial, we will approximate the problem by the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>The (initial) position and velocity of Asterix are given in the form of a Keplerian state vector.</p></li>
<li><p>The Earth is modeled as a point mass, and the spacecraft is modeled as massless.</p></li>
<li><p>All perturbations, such as solar radiation and third-body gravity, etc. are neglected.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a followup tutorial (see <a class="reference internal" href="perturbedEarthOrbitingSatellite.html#walkthroughsperturbedearthorbitingsatellite"><span class="std std-ref">Perturbed Earth-orbiting Satellite</span></a>), we will show how to extend the dynamical model of the spacecraft, slightly relaxing the last assumption.</p>
</div>
<p>The main focus of this tutorial is to provide insight into the use of the Tudat library for your application. Using this test case, we will show how you can use some of the elements of the Tudat library, namely:</p>
<blockquote>
<div><ul class="simple">
<li><p>The transformation from Keplerian elements (provided) to Cartesian elements (required by propagator).</p></li>
<li><p>The settings for the environment.</p></li>
<li><p>The settings for the acceleration models.</p></li>
<li><p>The settings for the state derivative model (propagator).</p></li>
<li><p>The settings for the numerical integrator.</p></li>
<li><p>The use of ‘create’ functions to parse these settings.</p></li>
</ul>
</div></blockquote>
<p>In particular, it will show you how these elements can work together to provide you with a powerful satellite propagator tool. It is not the intention to give you a C++ tutorial. Only the parts of the source code specific to Tudat will be discussed on this page. Detailed documentation on the environment models, acceleration models and propagators/integrators is available, but we recommend working through the tutorials here before delving into the details of all options that are available to you.</p>
<p>In Tudat, the environment, acceleration models and propagator are not created directly by the user. Instead, the user defines a number of ‘Settings’ objects that describe how the actual models are to be put together. These Settings objects are then passed to ‘create’ functions to build up the objects/data used in the simulations, and link them all together. In linking these objects together, information is automatically updated, and where necessary transformed and processed in the manner specified by the user in the Settings objects.</p>
<div class="section" id="set-up-the-environment">
<h2><span class="section-number">1.1. </span>Set Up the Environment<a class="headerlink" href="#set-up-the-environment" title="Permalink to this headline">¶</a></h2>
<p>First we discuss the setup of the environment, which is stored in a list of <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects, each of which represents either a natural celestial body, or a spacecraft (orbiter, entry vehicle, etc.). The entire environment (gravity fields, atmospheres, ephemerides, rotation models, etc.) are then defined as members of the corresponding <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object. For this example, the only environment models we need are:</p>
<blockquote>
<div><ul class="simple">
<li><p>Earth gravity field (point-mass).</p></li>
<li><p>Earth ephemeris model.</p></li>
</ul>
</div></blockquote>
<p>The block of code used to generate the environment that we require is:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create body objects.</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodiesToCreate</span><span class="p">;</span><span class="w"></span>
<span class="n">bodiesToCreate</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BodySettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">getDefaultBodySettings</span><span class="p">(</span><span class="w"> </span><span class="n">bodiesToCreate</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">bodySettings</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">ephemerisSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ConstantEphemerisSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create Earth object</span>
<span class="n">NamedBodyMap</span><span class="w"> </span><span class="n">bodyMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBodies</span><span class="p">(</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Creating an environment starts by creating the settings for all required environment models, which are stored in a list of <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a> objects. Each <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a> object has a list of objects for environment model settings, which are empty upon creation of the <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a>, and may be set by the user to their desired specifications. To save you the trouble of having to define all settings manually, we provide default options for the environment, many of which will often be sufficient for a given simulation. A list of all possible properties of the <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#BodySettings" title="BodySettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">BodySettings</span></code></a>, as well as the default settings, can be found <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#tudatfeaturescreatingtheenvironment"><span class="std std-ref">here</span></a>. In our example, we only need environment models for the Earth, so we start by:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodiesToCreate</span><span class="p">;</span><span class="w"></span>
<span class="n">bodiesToCreate</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">BodySettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">getDefaultBodySettings</span><span class="p">(</span><span class="w"> </span><span class="n">bodiesToCreate</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>With the settings that are now stored in the <code class="docutils literal notranslate"><span class="pre">bodySettings</span></code> map, we could generate our environment and move on to the next step of the simulation. However, both to showcase one of the options of setting up the environment, and for numerical accuracy, we make one modification to the default ephemeris settings, defining the Earth to be fixed at the center of the Solar system:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodySettings</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">]</span><span class="o">-&gt;</span><span class="n">ephemerisSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">ConstantEphemerisSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector6d</span><span class="o">::</span><span class="n">Zero</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>By using this code, we ‘cheat’ a little bit, since we put the Earth in the main inertial frame for Tudat: the Solar System Barycenter (something that is done by default by the <a class="reference internal" href="../tudatFeatures/environmentSetup/availableSettings.html#ConstantEphemerisSettings" title="ConstantEphemerisSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantEphemerisSettings</span></code></a>, since the second argument is not specified). This approach should <strong>only</strong> be used when considering no third-body perturbations. Note that we could have used any ephemeris setting for the Earth (since we propagate our satellite w.r.t. the Earth origin) without changing anything in our dynamical model, but at a slight loss of numerical precision.</p>
</div>
<p>Now, we have created the settings we need for the environment, and we can move on to creating the environment models themselves, which are stored in a set of <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects. These <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> objects are stored in a <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#NamedBodyMap" title="NamedBodyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedBodyMap</span></code></a>, which is a <code class="docutils literal notranslate"><span class="pre">typedef</span></code> (shorthand name) for:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">simulation_setup</span><span class="o">::</span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">unordered_map</span></code> may be accessed as a regular map. The <code class="docutils literal notranslate"><span class="pre">std::string</span></code> keys represent the names of the bodies in the list, and the value <code class="docutils literal notranslate"><span class="pre">std::shared_ptr</span></code> the corresponding <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object containing all the environment models. With the settings of our ephemeris and gravity field, we now create the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code> by:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NamedBodyMap</span><span class="w"> </span><span class="n">bodyMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBodies</span><span class="p">(</span><span class="w"> </span><span class="n">bodySettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="create-the-vehicle">
<h2><span class="section-number">1.2. </span>Create the Vehicle<a class="headerlink" href="#create-the-vehicle" title="Permalink to this headline">¶</a></h2>
<p>Our environment is now missing only one aspect: the spacecraft. Our spacecraft (called Asterix) requires no specific properties, it merely needs to exist (its initial state is defined in a subsequent part of the example). Therefore, we can simply add the Asterix satellite to our environment by creating a new empty <a class="reference internal" href="../tudatFeatures/environmentSetup/setup.html#Body" title="Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> object:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodyMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Asterix&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">simulation_setup</span><span class="o">::</span><span class="n">Body</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Although not required in this simulation, it is good practice to call the following function following the complete setup of the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">setGlobalFrameBodyEphemerides</span><span class="p">(</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SSB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ECLIPJ2000&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Calling this function will allow hierarchical ephemerides to be properly used in the simulation (i.e. orbiter ephemeris w.r.t. Moon, Moon w.r.t. Earth, Earth w.r.t. Sun, Sun w.r.t. barycenter).</p>
</div>
<div class="section" id="set-up-the-acceleration-odels">
<h2><span class="section-number">1.3. </span>Set Up the Acceleration  odels<a class="headerlink" href="#set-up-the-acceleration-odels" title="Permalink to this headline">¶</a></h2>
<p>To define the settings of the propagation of the orbit, we start by defining the required acceleration models. The block of code that performs the required operations is:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define propagator settings variables.</span>
<span class="n">SelectedAccelerationMap</span><span class="w"> </span><span class="n">accelerationMap</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">centralBodies</span><span class="p">;</span><span class="w"></span>

<span class="n">bodiesToPropagate</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Asterix&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">centralBodies</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Define propagation settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">accelerationsOfAsterix</span><span class="p">;</span><span class="w"></span>
<span class="n">accelerationsOfAsterix</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">central_gravity</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Asterix&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accelerationsOfAsterix</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Create acceleration models and propagation settings.</span>
<span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">AccelerationMap</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createAccelerationModelsMap</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationMap</span><span class="p">,</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">centralBodies</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>As with the environment models, there is no need to manually create the models. The user must only define the properties of the acceleration models that are desired, which are:</p>
<blockquote>
<div><ul class="simple">
<li><p>List of bodies that are to be numerically propagated.</p></li>
<li><p>Origin of reference frame in which they are to be propagated (may be different for each body). Note that propagation in Tudat is always done in a non-rotating reference frame, only the origin of the frames can be varied.</p></li>
<li><p>A list of settings of the accelerations model(s) acting on the bodies in the simulation.</p></li>
</ul>
</div></blockquote>
<p>These properties are to be defined in the following variables:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define propagator settings variables.</span>
<span class="n">SelectedAccelerationMap</span><span class="w"> </span><span class="n">accelerationMap</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">centralBodies</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The list of propagated bodies and the reference frame origins (central bodies) are simply lists of strings, which for our case are:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bodiesToPropagate</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Asterix&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">centralBodies</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The settings for the accelerations require some more structure, though, and are stored in a <a class="reference internal" href="../tudatFeatures/accelerationSetup/frameworkAcceleration.html#SelectedAccelerationMap" title="SelectedAccelerationMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectedAccelerationMap</span></code></a>. This is <code class="docutils literal notranslate"><span class="pre">typedef</span></code> for:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>This is a double map (with twice a string as a key). The two levels correspond to the names of bodies undergoing an acceleration (first key), and those for bodies exerting an acceleration (second key). This allows any number of bodies to be propagated, undergoing any number (and type) of accelerations. Mutual acceleration between bodies being propagated, as is the case for Solar system dynamics for instance, is automatically handled by the code and requires no specific consideration.</p>
<p>In our example, we have only a single point-mass acceleration due to Earth, acting on Asterix. We define the settings for the acceleration as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">accelerationsOfAsterix</span><span class="p">;</span><span class="w"></span>
<span class="n">accelerationsOfAsterix</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">AccelerationSettings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">                                                 </span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">central_gravity</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">accelerationMap</span><span class="p">[</span><span class="w"> </span><span class="s">&quot;Asterix&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accelerationsOfAsterix</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>A single acceleration, of type <code class="docutils literal notranslate"><span class="pre">central_gravity</span></code> to be exerted by body <code class="docutils literal notranslate"><span class="pre">&quot;Earth&quot;</span></code> on body <code class="docutils literal notranslate"><span class="pre">&quot;Asterix&quot;</span></code> is now defined. The list of the actual acceleration models is now created by:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">basic_astrodynamics</span><span class="o">::</span><span class="n">AccelerationMap</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createAccelerationModelsMap</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationMap</span><span class="p">,</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">centralBodies</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>which automatically links together all required objects and functions.</p>
</div>
<div class="section" id="set-up-the-propagation-settings">
<h2><span class="section-number">1.4. </span>Set Up the Propagation Settings<a class="headerlink" href="#set-up-the-propagation-settings" title="Permalink to this headline">¶</a></h2>
<p>Now that we have both our environment models and our acceleration model, we can create the full settings for the propagation. These settings are stored in a <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettings.html#PropagatorSettings" title="PropagatorSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropagatorSettings</span></code></a> object. For this example, we will only consider the propagation of translational dynamics, which is stored in the derived class <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettings.html#TranslationalStatePropagatorSettings" title="TranslationalStatePropagatorSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationalStatePropagatorSettings</span></code></a>. The settings for the propagator are the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>The acceleration models.</p></li>
<li><p>The list of bodies that are to be propagated.</p></li>
<li><p>The origins w.r.t. which these bodies are to be propagated.</p></li>
<li><p>The initial Cartesian state that is to be used.</p></li>
<li><p>Termination conditions for the propagation (here, a fixed final time).</p></li>
</ul>
</div></blockquote>
<p>The above settings are provided in the following block of code:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set Keplerian elements for Asterix.</span>
<span class="n">Vector6d</span><span class="w"> </span><span class="n">asterixInitialStateInKeplerianElements</span><span class="p">;</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">semiMajorAxisIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7500.0E3</span><span class="p">;</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">eccentricityIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">inclinationIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">85.3</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">argumentOfPeriapsisIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">235.7</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">longitudeOfAscendingNodeIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">23.4</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">trueAnomalyIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">139.87</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Convert Asterix state from Keplerian elements to Cartesian elements.</span>
<span class="kt">double</span><span class="w"> </span><span class="n">earthGravitationalParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getGravityFieldModel</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getGravitationalParameter</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">systemInitialState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertKeplerianToCartesianElements</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">asterixInitialStateInKeplerianElements</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">earthGravitationalParameter</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Create propagator settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TranslationalStatePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">propagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TranslationalStatePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="n">centralBodies</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="p">,</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">systemInitialState</span><span class="p">,</span><span class="w"> </span><span class="n">simulationEndEpoch</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>If the body that is being propagated has a pre-existing ephemeris, the initial state may be retrieved automatically. In this example, however, we manually define our initial state from the Keplerian state:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set Keplerian elements for Asterix.</span>
<span class="n">Vector6d</span><span class="w"> </span><span class="n">asterixInitialStateInKeplerianElements</span><span class="p">;</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">semiMajorAxisIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7500.0E3</span><span class="p">;</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">eccentricityIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">inclinationIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">85.3</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">argumentOfPeriapsisIndex</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">235.7</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">longitudeOfAscendingNodeIndex</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">23.4</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">asterixInitialStateInKeplerianElements</span><span class="p">(</span><span class="w"> </span><span class="n">trueAnomalyIndex</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertDegreesToRadians</span><span class="p">(</span><span class="w"> </span><span class="mf">139.87</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">// Convert Asterix state from Keplerian elements to Cartesian elements.</span>
<span class="kt">double</span><span class="w"> </span><span class="n">earthGravitationalParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyMap</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Earth&quot;</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getGravityFieldModel</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="o">-&gt;</span><span class="n">getGravitationalParameter</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="n">systemInitialState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertKeplerianToCartesianElements</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">asterixInitialStateInKeplerianElements</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">earthGravitationalParameter</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Note that we use the Earth gravity field inside the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code> for the conversion from Keplerian to Cartesian coordinates. Now, we can create our propagator settings with:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create propagator settings.</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TranslationalStatePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">propagatorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">TranslationalStatePropagatorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="n">centralBodies</span><span class="p">,</span><span class="w"> </span><span class="n">accelerationModelMap</span><span class="p">,</span><span class="w"> </span><span class="n">bodiesToPropagate</span><span class="p">,</span><span class="w"> </span><span class="n">systemInitialState</span><span class="p">,</span><span class="w"> </span><span class="n">simulationEndEpoch</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>where we have passed exactly the five aspects listed above as input to the <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettings.html#TranslationalStatePropagatorSettings" title="TranslationalStatePropagatorSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationalStatePropagatorSettings</span></code></a>. If you have a look at the code for the <a class="reference internal" href="../tudatFeatures/propagationSetup/propagatorSettings.html#TranslationalStatePropagatorSettings" title="TranslationalStatePropagatorSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationalStatePropagatorSettings</span></code></a>, you will notice that there are multiple constructors for the class, each with a number of additional input arguments (for which we use the default values). These more advanced options are discussed in following tutorials.</p>
<p>A final piece of information needed to propagate the orbit is the settings object for the numerical integration. We use a Runge-Kutta 4 integrator, with a 10 second time step, starting the numerical integration at <span class="math notranslate nohighlight">\(t = 0\)</span>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create numerical integrator settings.</span>
<span class="kt">double</span><span class="w"> </span><span class="n">simulationStartEpoch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">fixedStepSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="w"> </span><span class="n">IntegratorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">integratorSettings</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="w"> </span><span class="n">IntegratorSettings</span><span class="o">&lt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="n">rungeKutta4</span><span class="p">,</span><span class="w"> </span><span class="n">simulationStartEpoch</span><span class="p">,</span><span class="w"> </span><span class="n">fixedStepSize</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="perform-the-orbit-propagation">
<h2><span class="section-number">1.5. </span>Perform the Orbit Propagation<a class="headerlink" href="#perform-the-orbit-propagation" title="Permalink to this headline">¶</a></h2>
<p>Now, we have defined all the information needed to propagate the orbit of our satellite, which are stored in the <code class="docutils literal notranslate"><span class="pre">bodyMap</span></code> (environment), <code class="docutils literal notranslate"><span class="pre">propagatorSettings</span></code> (settings for the full state derivative model) and <code class="docutils literal notranslate"><span class="pre">integratorSettings</span></code> (settings on how to obtain the numerical solution). The propagation is done by an object of type (derived from) <a class="reference internal" href="../tudatFeatures/propagationSetup/simulatorCreation.html#DynamicsSimulator" title="DynamicsSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DynamicsSimulator</span></code></a>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SingleArcDynamicsSimulator</span><span class="o">&lt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">dynamicsSimulator</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">bodyMap</span><span class="p">,</span><span class="w"> </span><span class="n">integratorSettings</span><span class="p">,</span><span class="w"> </span><span class="n">propagatorSettings</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Upon creating this class, the numerical propagation is performed, and the output is stored in the class. Various options exist for parsing the output of the numerical propagation, which will be discussed in the next tutorials. The numerical solution of the orbit can be retrieved as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">integrationResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dynamicsSimulator</span><span class="p">.</span><span class="n">getEquationsOfMotionNumericalSolution</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>where the retrieved result is a <code class="docutils literal notranslate"><span class="pre">std::map</span></code> where the key <code class="docutils literal notranslate"><span class="pre">double</span></code> is the time at each step in the integration, and the value, <code class="docutils literal notranslate"><span class="pre">Eigen::VectorXd</span></code>, is the corresponding Cartesian state of Asterix w.r.t. the Earth, in the ECLIPJ2000 reference frame. To analyze/plot your numerical results further using e.g. MATLAB, you can print the output to a text file as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Write satellite propagation history to file.</span>
<span class="n">input_output</span><span class="o">::</span><span class="n">writeDataMapToTextFile</span><span class="p">(</span><span class="w"> </span><span class="n">integrationResult</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="s">&quot;singleSatellitePropagationHistory.dat&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">tudat_applications</span><span class="o">::</span><span class="n">getOutputPath</span><span class="p">(</span><span class="w"> </span><span class="p">),</span><span class="w"></span>
<span class="w">                                      </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">digits10</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">digits10</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>For more details about the input and output basics go to: <a class="reference internal" href="../tudatFeatures/otherLibraries/inputOutput.html#tudatfeaturesinputoutput"><span class="std std-ref">Input/Output</span></a>.</p>
</div>
<div class="section" id="results">
<h2><span class="section-number">1.6. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>The output of the program should look similar to the output below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Starting</span> <span class="o">../</span><span class="n">tudatBundle</span><span class="o">/</span><span class="n">tudatExampleApplications</span><span class="o">/</span><span class="n">satellitePropagatorExamples</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">applications</span><span class="o">/</span><span class="n">application_SingleSatellitePropagator</span><span class="o">...</span>
<span class="n">Single</span> <span class="n">Earth</span><span class="o">-</span><span class="n">Orbiting</span> <span class="n">Satellite</span> <span class="n">Example</span><span class="o">.</span>
<span class="n">The</span> <span class="n">initial</span> <span class="n">position</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">Asterix</span> <span class="ow">is</span> <span class="p">[</span><span class="n">km</span><span class="p">]:</span>
<span class="mf">7037.48</span>
<span class="mf">3238.06</span>
<span class="mf">2150.72</span>
<span class="n">The</span> <span class="n">initial</span> <span class="n">velocity</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">Asterix</span> <span class="ow">is</span> <span class="p">[</span><span class="n">km</span><span class="o">/</span><span class="n">s</span><span class="p">]:</span>
  <span class="o">-</span><span class="mf">1.46566</span>
<span class="o">-</span><span class="mf">0.0409584</span>
    <span class="mf">6.6228</span>
<span class="n">After</span> <span class="mi">86400</span> <span class="n">seconds</span><span class="p">,</span> <span class="n">the</span> <span class="n">position</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">Asterix</span> <span class="ow">is</span> <span class="p">[</span><span class="n">km</span><span class="p">]:</span>
<span class="o">-</span><span class="mf">4560.45</span>
<span class="o">-</span><span class="mf">1438.32</span>
 <span class="mf">5973.99</span>
<span class="n">And</span> <span class="n">the</span> <span class="n">velocity</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">Asterix</span> <span class="ow">is</span> <span class="p">[</span><span class="n">km</span><span class="o">/</span><span class="n">s</span><span class="p">]:</span>
<span class="o">-</span><span class="mf">4.55021</span>
<span class="o">-</span><span class="mf">2.41254</span>
<span class="o">-</span><span class="mf">4.95063</span>
<span class="o">../</span><span class="n">tudatBundle</span><span class="o">/</span><span class="n">tudatExampleApplications</span><span class="o">/</span><span class="n">satellitePropagatorExamples</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">applications</span><span class="o">/</span><span class="n">application_SingleSatellitePropagator</span> <span class="n">exited</span> <span class="k">with</span> <span class="n">code</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="perturbedEarthOrbitingSatellite.html" class="btn btn-neutral float-right" title="2. Perturbed Earth-orbiting Satellite" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Application Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>⚠️ This website is now mostly outdated! ⚠️</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>