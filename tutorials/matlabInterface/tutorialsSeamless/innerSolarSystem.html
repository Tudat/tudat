

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Inner Solar System Propagation &mdash; TU Delft Astrodynamic Toolbox  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="TU Delft Astrodynamic Toolbox  documentation" href="../../../index.html"/>
        <link rel="up" title="Tutorials: Seamless" href="index.html"/>
        <link rel="next" title="Galileo Constellation Propagation" href="galileoConstellation.html"/>
        <link rel="prev" title="Multiple propagations" href="multiplePropagations.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> TU Delft Astrodynamic Toolbox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Start Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials and Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../applicationWalkthroughs/index.html">Application Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tudatFeatures/index.html">Tudat Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/index.html">Tudat Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jsonInterface/index.html">JSON Interface</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">MATLAB Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Tutorials: Seamless</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="basicPropagation.html">Unperturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="singlePerturbedSatellite.html">Perturbed Earth-orbiting Satellite</a></li>
<li class="toctree-l4"><a class="reference internal" href="multiplePropagations.html">Multiple propagations</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Inner Solar System Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="galileoConstellation.html">Galileo Constellation Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="thrustAlongVelocityVector.html">Thrust force along velocity vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="thrustAccelerationFromFile.html">Thrust vector read from tabulated file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorialsInputOutput/index.html">Tutorials: Input-Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="http://doxygen.tudat.tudelft.nl">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developerGuide/index.html">Developer Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">TU Delft Astrodynamic Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Tutorials and Documentation</a> &raquo;</li>
        
          <li><a href="../index.html">MATLAB Interface</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials: Seamless</a> &raquo;</li>
        
      <li>Inner Solar System Propagation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/tutorials/matlabInterface/tutorialsSeamless/innerSolarSystem.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="inner-solar-system-propagation">
<span id="matlabinterface-tutorialsseamless-innersolarsystem"></span><h1>Inner Solar System Propagation<a class="headerlink" href="#inner-solar-system-propagation" title="Permalink to this headline">¶</a></h1>
<p>This tutorial describes how the orbit of the inner Solar system bodies can be propagated using the MATLAB Interface, similar to the example <a class="reference internal" href="../../applicationWalkthroughs/innerSolarSystemPropagation.html#walkthroughsinnersolarsystempropagation"><span class="std std-ref">Inner Solar System Propagation</span></a> written in C++. The code for this example can be found at:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>tudatBundle/matlabInterface/Examples/Seamless/innerSolarSystem.m
</pre></div>
</div>
<p>The first step is to include the source code of the MATLAB Interface into MATLAB’s path in the current session so that all the classes needed to set up the simulation can be accessed. This is done by writing:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">tudat</span><span class="p">.</span><span class="n">load</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>Now, we create a <code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code> object and specify the initial and final epochs and the global frame orientation:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Simulation</span><span class="p">();</span><span class="w"></span>
<span class="n">simulation</span><span class="p">.</span><span class="n">initialEpoch</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e7</span><span class="p">;</span><span class="w"></span>
<span class="n">simulation</span><span class="p">.</span><span class="n">finalEpoch</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">simulation</span><span class="p">.</span><span class="n">initialEpoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">convert</span><span class="p">.</span><span class="n">toSI</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">simulation</span><span class="p">.</span><span class="n">spice</span><span class="p">.</span><span class="n">preloadEphemeris</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Note that the function <code class="docutils literal notranslate"><span class="pre">toSI</span></code> from the <code class="docutils literal notranslate"><span class="pre">convert</span></code> package has been used to convert 2 years to seconds. In this case, we disable preloading ephemeris of the celestial bodies from Spice, as this is precisely what we are going to propagate.</p>
<p>Next, we create the bodies. There exist predefined objects for celestial bodies (namely the Sun, the Moon and the eight planets), so these objects can be added directly without the need to specify their properties:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="p">.</span><span class="n">addBodies</span><span class="p">(</span><span class="n">Sun</span><span class="p">,</span><span class="n">Mercury</span><span class="p">,</span><span class="n">Venus</span><span class="p">,</span><span class="n">Earth</span><span class="p">,</span><span class="n">Moon</span><span class="p">,</span><span class="n">Mars</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Now we need to specify the accelerations acting on each body. The accelerations acting on each body are the point-mass gravitational attractions caused by the other bodies. We can define all the accelerations by writing a nested for-loop:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">bodyNames</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fieldnames</span><span class="p">(</span><span class="n">simulation</span><span class="p">.</span><span class="n">bodies</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">bodyNames</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">j</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">bodyNames</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="nb">j</span><span class="w"></span>
<span class="w">            </span><span class="n">accelerations</span><span class="p">.(</span><span class="n">bodyNames</span><span class="p">{</span><span class="nb">i</span><span class="p">}).(</span><span class="n">bodyNames</span><span class="p">{</span><span class="nb">j</span><span class="p">})</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">PointMassGravity</span><span class="p">()};</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>Note that the names of the bodies have been retrieved from <code class="docutils literal notranslate"><span class="pre">fieldnames(simulation.bodies)</span></code>.</p>
<p>Then, we create the settings for the propagation. We are going to propagate the translational state of the celestial bodies. Thus, we use a <code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationalPropagator</span></code>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">propagator</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TranslationalPropagator</span><span class="p">();</span><span class="w"></span>
<span class="n">propagator</span><span class="p">.</span><span class="n">bodiesToPropagate</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bodyNames</span><span class="p">;</span><span class="w"></span>
<span class="n">propagator</span><span class="p">.</span><span class="n">centralBodies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">({</span><span class="s">&#39;SSB&#39;</span><span class="p">},</span><span class="nb">size</span><span class="p">(</span><span class="n">bodyNames</span><span class="p">));</span><span class="w"></span>
<span class="n">propagator</span><span class="p">.</span><span class="n">accelerations</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">accelerations</span><span class="p">;</span><span class="w"></span>
<span class="n">simulation</span><span class="p">.</span><span class="n">propagators</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="n">propagator</span><span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>In this case, we use an hypothetical central body named <code class="docutils literal notranslate"><span class="pre">SSB</span></code> (Solar system barycentre) for all the celestial bodies. The built-in function <code class="docutils literal notranslate"><span class="pre">repmat</span></code> is used to create a cell array containing <code class="docutils literal notranslate"><span class="pre">'SSB'</span></code> repeated six times in this case.</p>
<p>Finally, we define the integrator settings, in this case we use a Runge-Kutta 4 integrator with a fixed step-size of one hour:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="p">.</span><span class="n">integrator</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Integrators</span><span class="p">.</span><span class="n">rungeKutta4</span><span class="p">;</span><span class="w"></span>
<span class="n">simulation</span><span class="p">.</span><span class="n">integrator</span><span class="p">.</span><span class="n">stepSize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3600</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>All the settings needed to run the simulation have been defined. Thus, we can write:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="p">.</span><span class="n">run</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>This method creates a temporary input file and calls the <code class="docutils literal notranslate"><span class="pre">json_interface</span></code> application, generating a temporary output file containing the state of the satellite for each integration step. Then, it loads these results into the struct <code class="docutils literal notranslate"><span class="pre">results</span></code> of the <code class="docutils literal notranslate"><span class="pre">simulation</span></code> object. Finally, all the temporary files are deleted.</p>
<p>After running the simulation, if no specific results have been requested, we can obtain the numerical solution of the equations of motion from <code class="docutils literal notranslate"><span class="pre">simulation.results.numericalSolution</span></code>. This is a matrix containing in each row the results of an integration step. The first column contains the epochs, while the columns 2 to 7 contain the associated Cartesian states of the first propagated body (the Sun), columns 8 to 13 the Cartesian states of the second propagated body (Mercury), and so on. We can retrieve the positions for each body and save them in the struct <code class="docutils literal notranslate"><span class="pre">r</span></code> by writing:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">bodyNames</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">fromIndex</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">toIndex</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">fromIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">r</span><span class="p">.(</span><span class="n">bodyNames</span><span class="p">{</span><span class="nb">i</span><span class="p">})</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">convert</span><span class="p">.</span><span class="n">fromSI</span><span class="p">(</span><span class="n">simulation</span><span class="p">.</span><span class="n">results</span><span class="p">.</span><span class="n">numericalSolution</span><span class="p">(:,</span><span class="n">fromIndex</span><span class="p">:</span><span class="n">toIndex</span><span class="p">),</span><span class="s">&#39;AU&#39;</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>Note the use of the function <code class="docutils literal notranslate"><span class="pre">fromSI</span></code> of the <code class="docutils literal notranslate"><span class="pre">convert</span></code> package, which in this case converts metres to astronomical units.</p>
<p>Finally, we generate a plot showing the positions of the celestial bodies during the propagation period of two years, which yields the orbits of the planets:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">figure</span><span class="p">;</span><span class="w"></span>
<span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">bodyNames</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">bodyPosition</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">r</span><span class="p">.(</span><span class="n">bodyNames</span><span class="p">{</span><span class="nb">i</span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="nb">plot3</span><span class="p">(</span><span class="n">bodyPosition</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">bodyPosition</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">bodyPosition</span><span class="p">(:,</span><span class="mi">3</span><span class="p">));</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="nb">legend</span><span class="p">(</span><span class="n">bodyNames</span><span class="p">{:});</span><span class="w"></span>
<span class="nb">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1</span><span class="w"> </span><span class="mf">0.1</span><span class="p">]);</span><span class="w"></span>
<span class="n">axis</span><span class="w"> </span><span class="s">equal</span><span class="p">;</span><span class="w"></span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;X [AU]&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Y [AU]&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">zlabel</span><span class="p">(</span><span class="s">&#39;Z [AU]&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<img alt="../../../_images/innerSolarSystem.png" src="../../../_images/innerSolarSystem.png" />
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="galileoConstellation.html" class="btn btn-neutral float-right" title="Galileo Constellation Propagation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="multiplePropagations.html" class="btn btn-neutral" title="Multiple propagations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Delft University of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header .arrow").click(function() {
            $(this).closest('.toggle').children().not(".header").toggle(400);
            $(this).toggleClass("open");
            // $(this).html() == "More" ? $(this).html('Less') : $(this).html('More');
        });
        $(".showall").click(function() {
            $(".toggle > *").show(400);
            $(".toggle .header .arrow").addClass("open");
        });
        $(".hideall").click(function() {
            $(".toggle > *").hide(400);
            $(".toggle .header").show(400);
            $(".toggle .header .arrow").removeClass("open");
        });

        var nav_top_height = Math.round($(".wy-side-nav-search").outerHeight())+2;
        $(".wy-nav-content-wrap").prepend("<div id='announcement'><p>⚠️ This website is now mostly outdated! ⚠️</p><p>Please visit <a href='https://tudat-space.readthedocs.io/en/latest'>tudat-space.readthedocs.io</a> instead.</p></div>");
        $("#announcement").css("height", String(nav_top_height) + "px");
        $(".rst-content").css("margin-top", String(nav_top_height) + "px");
    });
</script>


</body>
</html>